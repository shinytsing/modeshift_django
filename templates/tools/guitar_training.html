{% extends 'base.html' %}
{% load static %}

{% block tool_title_inner %}ğŸ¸ ä¸æ‘‡å°±æ»š - å‰ä»–è®­ç»ƒç³»ç»Ÿ{% endblock %}
{% block tool_title_display %}ğŸ¸ ä¸æ‘‡å°±æ»š - å‰ä»–è®­ç»ƒç³»ç»Ÿ{% endblock %}

{% block extra_css %}
<style>


/* å‰ä»–è®­ç»ƒç³»ç»Ÿæ ·å¼ */
.guitar-training-container {
  min-height: 100vh;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533483 75%, #e94560 100%);
  color: #ffffff;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  padding: 2rem;
  position: relative;
  overflow: hidden;
}

/* æµ®åŠ¨éŸ³ç¬¦èƒŒæ™¯ */
.floating-notes {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
}

.note {
  position: absolute;
  font-size: 2rem;
  opacity: 0.3;
  animation: floatNote 8s ease-in-out infinite;
}

@keyframes floatNote {
  0%, 100% { 
    transform: translateY(0px) rotate(0deg);
    opacity: 0.3;
  }
  50% { 
    transform: translateY(-20px) rotate(180deg);
    opacity: 0.6;
  }
}

/* å¤´éƒ¨æ ·å¼ */
.guitar-header {
  text-align: center;
  margin-bottom: 40px;
  padding: 40px 0;
  position: relative;
  z-index: 1;
}

.guitar-title {
  font-size: 3.5rem;
  font-weight: 900;
  color: #ffffff;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  text-shadow: 0 4px 20px rgba(233, 69, 96, 0.5);
}

.guitar-title i {
  font-size: 3rem;
  animation: guitarPulse 2s ease-in-out infinite;
}

@keyframes guitarPulse {
  0%, 100% { 
    transform: scale(1) rotate(0deg);
  }
  50% { 
    transform: scale(1.1) rotate(5deg);
  }
}

.guitar-subtitle {
  font-size: 1.3rem;
  color: rgba(255,255,255,0.9);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 2px;
  animation: subtitleFloat 4s ease-in-out infinite;
}

@keyframes subtitleFloat {
  0%, 100% { transform: translateY(0px); opacity: 0.9; }
  50% { transform: translateY(-5px); opacity: 1; }
}

/* åŠŸèƒ½ç½‘æ ¼ */
.guitar-tools-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 2.5rem;
  max-width: 1400px;
  margin: 0 auto;
  position: relative;
  z-index: 1;
}

.guitar-card {
  background: linear-gradient(135deg, rgba(233, 69, 96, 0.1) 0%, rgba(83, 52, 131, 0.1) 100%);
  border: 2px solid rgba(233, 69, 96, 0.3);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(233, 69, 96, 0.2);
  backdrop-filter: blur(20px);
  transition: all 0.4s ease;
  padding: 28px;
  text-align: center;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.guitar-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(233, 69, 96, 0.1), transparent);
  transition: left 0.6s ease;
}

.guitar-card:hover::before {
  left: 100%;
}

.guitar-card:hover {
  border-color: rgba(233, 69, 96, 0.6);
  transform: translateY(-8px) scale(1.02);
  box-shadow: 0 20px 60px rgba(233, 69, 96, 0.3);
}

.guitar-icon {
  font-size: 4rem;
  color: #e94560;
  margin-bottom: 1.5rem;
  animation: iconFloat 3s ease-in-out infinite;
}

@keyframes iconFloat {
  0%, 100% { 
    transform: translateY(0px);
  }
  50% { 
    transform: translateY(-10px);
  }
}

.guitar-title-text {
  font-size: 1.8rem;
  font-weight: 700;
  color: #ffffff;
  margin-bottom: 1rem;
  text-shadow: 0 2px 10px rgba(233, 69, 96, 0.3);
}

.guitar-description {
  color: rgba(255,255,255,0.8);
  margin-bottom: 2rem;
  line-height: 1.6;
  font-size: 1rem;
}

/* è°ƒéŸ³å™¨æ ·å¼ */
.tuner-container {
  background: rgba(0, 0, 0, 0.8);
  border-radius: 15px;
  padding: 20px;
  margin-top: 20px;
  display: none;
}

.tuner-display {
  text-align: center;
  margin-bottom: 20px;
}

.tuner-note {
  font-size: 4rem;
  font-weight: bold;
  color: #e94560;
  margin-bottom: 10px;
}

.tuner-frequency {
  font-size: 1.2rem;
  color: #ffffff;
  margin-bottom: 20px;
}

.tuner-meter {
  width: 100%;
  height: 60px;
  background: #333;
  border-radius: 10px;
  position: relative;
  overflow: hidden;
  margin-bottom: 20px;
}

.tuner-indicator {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 4px;
  height: 80%;
  background: #e94560;
  transform: translate(-50%, -50%);
  transition: left 0.1s ease;
  border-radius: 2px;
}

.tuner-scale {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 20px;
  color: #ffffff;
  font-size: 0.8rem;
}

.tuner-controls {
  display: flex;
  justify-content: center;
  gap: 15px;
}

.tuner-btn {
  background: #e94560;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1rem;
  transition: all 0.3s ease;
}

.tuner-btn:hover {
  background: #d63384;
  transform: translateY(-2px);
}

/* å’Œå¼¦è®­ç»ƒå™¨æ ·å¼ */
.chord-trainer {
  background: rgba(0, 0, 0, 0.8);
  border-radius: 15px;
  padding: 20px;
  margin-top: 20px;
  display: none;
}

.chord-fretboard {
  width: 100%;
  height: 200px;
  background: linear-gradient(45deg, #8B4513, #A0522D);
  border-radius: 10px;
  position: relative;
  margin-bottom: 20px;
  border: 3px solid #654321;
}

.chord-info {
  text-align: center;
  margin-bottom: 20px;
}

.chord-name {
  font-size: 2rem;
  font-weight: bold;
  color: #e94560;
  margin-bottom: 10px;
}

.chord-progress {
  width: 100%;
  height: 20px;
  background: #333;
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 20px;
}

.chord-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #e94560, #ff6b9d);
  transition: width 0.3s ease;
  width: 0%;
}

/* èŠ‚å¥è®­ç»ƒå™¨æ ·å¼ */
.rhythm-trainer {
  background: rgba(0, 0, 0, 0.8);
  border-radius: 15px;
  padding: 20px;
  margin-top: 20px;
  display: none;
}

.metronome {
  text-align: center;
  margin-bottom: 20px;
}

.bpm-display {
  font-size: 3rem;
  font-weight: bold;
  color: #e94560;
  margin-bottom: 20px;
}

.bpm-controls {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  margin-bottom: 20px;
}

.bpm-btn {
  background: #e94560;
  color: white;
  border: none;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 1.5rem;
  transition: all 0.3s ease;
}

.bpm-btn:hover {
  background: #d63384;
  transform: scale(1.1);
}

.bpm-slider {
  width: 200px;
  height: 8px;
  background: #333;
  border-radius: 4px;
  outline: none;
  -webkit-appearance: none;
}

.bpm-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px;
  height: 20px;
  background: #e94560;
  border-radius: 50%;
  cursor: pointer;
}

/* ç»ƒä¹ è®¡åˆ’æ ·å¼ */
.practice-plan {
  background: rgba(0, 0, 0, 0.8);
  border-radius: 15px;
  padding: 20px;
  margin-top: 20px;
  display: none;
}

.plan-header {
  text-align: center;
  margin-bottom: 20px;
}

.plan-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: #e94560;
  margin-bottom: 10px;
}

.plan-list {
  list-style: none;
  padding: 0;
}

.plan-item {
  background: rgba(233, 69, 96, 0.1);
  border: 1px solid rgba(233, 69, 96, 0.3);
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 10px;
  transition: all 0.3s ease;
}

.plan-item:hover {
  background: rgba(233, 69, 96, 0.2);
  transform: translateX(5px);
}

.plan-day {
  font-weight: bold;
  color: #e94560;
  margin-bottom: 5px;
}

.plan-content {
  color: #ffffff;
  font-size: 0.9rem;
}

/* ç¤¾åŒºæŒ‘æˆ˜æ ·å¼ */
.community-challenge {
  background: rgba(0, 0, 0, 0.8);
  border-radius: 15px;
  padding: 20px;
  margin-top: 20px;
  display: none;
}

.challenge-header {
  text-align: center;
  margin-bottom: 20px;
}

.challenge-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: #e94560;
  margin-bottom: 10px;
}

.challenge-song {
  background: rgba(233, 69, 96, 0.1);
  border: 1px solid rgba(233, 69, 96, 0.3);
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
}

.song-title {
  font-weight: bold;
  color: #ffffff;
  margin-bottom: 5px;
}

.song-difficulty {
  color: #e94560;
  font-size: 0.9rem;
  margin-bottom: 10px;
}

.song-progress {
  width: 100%;
  height: 10px;
  background: #333;
  border-radius: 5px;
  overflow: hidden;
}

.song-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #e94560, #ff6b9d);
  transition: width 0.3s ease;
  width: 0%;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .guitar-tools-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .guitar-title {
    font-size: 2.5rem;
  }
  
  .guitar-card {
    padding: 20px;
  }
}

/* å‰ä»–æ‰“å¡æ—¥å†æ ·å¼ */
.checkin-calendar-card {
  cursor: default !important;
}

.checkin-calendar-container {
  padding: 20px;
}

.calendar-nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  gap: 10px;
}

.nav-btn {
  background: linear-gradient(135deg, #e94560 0%, #d63384 100%);
  border: none;
  color: white;
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s ease;
}

.nav-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(233, 69, 96, 0.4);
}

.today-btn {
  background: #e94560;
  color: white;
}

.current-month {
  font-size: 1.2rem;
  font-weight: bold;
  color: #e94560;
  text-align: center;
  flex: 1;
}

.streak-info {
  display: flex;
  justify-content: space-around;
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(233, 69, 96, 0.1);
  border-radius: 10px;
  border: 1px solid rgba(233, 69, 96, 0.3);
}

.streak-item {
  display: flex;
  align-items: center;
  gap: 8px;
  color: #e94560;
  font-weight: bold;
}

.streak-item i {
  font-size: 1.2rem;
  animation: flame 1.5s ease-in-out infinite alternate;
}

@keyframes flame {
  0% { transform: scale(1); }
  100% { transform: scale(1.1); }
}

.calendar-grid {
  margin-bottom: 20px;
}

.calendar-header {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 2px;
  margin-bottom: 10px;
}

.calendar-header > div {
  text-align: center;
  font-weight: bold;
  color: #e94560;
  padding: 10px;
  font-size: 0.9rem;
}

.calendar-body {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 2px;
}

.calendar-day {
  aspect-ratio: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(233, 69, 96, 0.2);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: bold;
  position: relative;
  overflow: hidden;
}

.calendar-day:hover {
  background: rgba(233, 69, 96, 0.2);
  transform: scale(1.05);
  z-index: 2;
}

.calendar-day.other-month {
  opacity: 0.3;
  background: rgba(255, 255, 255, 0.02);
}

.calendar-day.today {
  background: linear-gradient(135deg, #e94560 0%, #d63384 100%);
  color: white;
  border-color: #e94560;
  box-shadow: 0 0 15px rgba(233, 69, 96, 0.5);
}

.calendar-day.completed {
  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
  color: white;
  border-color: #28a745;
}

.calendar-day.completed::after {
  content: 'ğŸ¸';
  position: absolute;
  top: 2px;
  right: 2px;
  font-size: 0.8rem;
}

.calendar-day.rest {
  background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
  color: white;
  border-color: #6c757d;
}

.calendar-day.rest::after {
  content: 'ğŸ˜´';
  position: absolute;
  top: 2px;
  right: 2px;
  font-size: 0.8rem;
}

.monthly-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
  margin-top: 20px;
}

.stat-item {
  text-align: center;
  padding: 15px;
  background: rgba(233, 69, 96, 0.1);
  border-radius: 10px;
  border: 1px solid rgba(233, 69, 96, 0.3);
}

.stat-value {
  font-size: 1.5rem;
  font-weight: bold;
  color: #e94560;
  margin-bottom: 5px;
}

.stat-label {
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.7);
}

/* å‰ä»–æ‰“å¡æ¨¡æ€æ¡†æ ·å¼ */
.checkin-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(5px);
}

.checkin-modal-content {
  background: linear-gradient(135deg, rgba(26,26,46,0.95) 0%, rgba(22,33,62,0.95) 100%);
  border: 2px solid rgba(233, 69, 96, 0.3);
  border-radius: 16px;
  padding: 30px;
  max-width: 500px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  color: white;
}

.checkin-modal-content h3 {
  color: #e94560;
  margin-bottom: 20px;
  text-align: center;
  font-size: 1.5rem;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  color: rgba(255, 255, 255, 0.7);
  font-weight: bold;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 12px;
  border: 1px solid rgba(233, 69, 96, 0.3);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.1);
  color: white;
  font-size: 14px;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: #e94560;
  box-shadow: 0 0 10px rgba(233, 69, 96, 0.3);
}

.form-group input::placeholder,
.form-group textarea::placeholder {
  color: rgba(255, 255, 255, 0.5);
}

.checkin-detail {
  background: rgba(255, 255, 255, 0.05);
  padding: 20px;
  border-radius: 10px;
  margin-bottom: 20px;
}

.checkin-detail p {
  margin-bottom: 10px;
  line-height: 1.6;
}

.checkin-detail strong {
  color: #e94560;
}

.form-actions {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
  margin-top: 20px;
}

.btn-cancel,
.btn-submit,
.btn-edit,
.btn-delete {
  padding: 10px 20px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s ease;
}

.btn-cancel {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.btn-submit,
.btn-edit {
  background: linear-gradient(135deg, #e94560 0%, #d63384 100%);
  color: white;
}

.btn-delete {
  background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
  color: white;
}

.btn-cancel:hover,
.btn-submit:hover,
.btn-edit:hover,
.btn-delete:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* èŠ‚æ‹å™¨æ ·å¼ */
.metronome {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 20px;
  border: 1px solid rgba(233, 69, 96, 0.2);
}

.metronome-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.metronome-header h4 {
  color: #e94560;
  margin: 0;
  font-size: 1.1rem;
}

.metronome-status {
  font-size: 0.9rem;
  font-weight: bold;
  color: #f44336;
}

.bpm-section {
  text-align: center;
  margin-bottom: 20px;
}

.bpm-display {
  font-size: 3rem;
  font-weight: bold;
  color: #e94560;
  text-shadow: 0 0 10px rgba(233, 69, 96, 0.3);
  margin-bottom: 5px;
}

.bpm-label {
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.7);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.bpm-controls {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
}

.bpm-btn {
  background: rgba(233, 69, 96, 0.2);
  color: white;
  border: 1px solid rgba(233, 69, 96, 0.3);
  border-radius: 6px;
  padding: 8px 12px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s ease;
  min-width: 40px;
}

.bpm-btn:hover {
  background: rgba(233, 69, 96, 0.4);
  transform: translateY(-2px);
}

.bpm-slider {
  flex: 1;
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
  outline: none;
  -webkit-appearance: none;
}

.bpm-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: #e94560;
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 0 10px rgba(233, 69, 96, 0.5);
}

.bpm-slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: #e94560;
  border-radius: 50%;
  cursor: pointer;
  border: none;
  box-shadow: 0 0 10px rgba(233, 69, 96, 0.5);
}

.bpm-presets {
  display: flex;
  gap: 8px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

.preset-btn {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 0.8rem;
  transition: all 0.3s ease;
}

.preset-btn:hover {
  background: rgba(233, 69, 96, 0.3);
  border-color: #e94560;
}

.metronome-controls {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

.tuner-btn.primary {
  background: linear-gradient(135deg, #e94560 0%, #d63384 100%);
  border-color: #e94560;
}

.time-signature {
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: center;
}

.time-signature label {
  color: rgba(255, 255, 255, 0.7);
  font-size: 0.9rem;
}

.time-signature select {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  border: 1px solid rgba(233, 69, 96, 0.3);
  border-radius: 6px;
  padding: 6px 12px;
  font-size: 0.9rem;
}

.time-signature select:focus {
  outline: none;
  border-color: #e94560;
  box-shadow: 0 0 10px rgba(233, 69, 96, 0.3);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .calendar-nav {
    flex-wrap: wrap;
    gap: 5px;
  }
  
  .nav-btn {
    padding: 6px 10px;
    font-size: 0.9rem;
  }
  
  .current-month {
    font-size: 1rem;
    order: -1;
    width: 100%;
    margin-bottom: 10px;
  }
  
  .streak-info {
    flex-direction: column;
    gap: 10px;
  }
  
  .monthly-stats {
    grid-template-columns: 1fr;
  }
  
  .checkin-modal-content {
    padding: 20px;
    margin: 20px;
  }
  
  .form-actions {
    flex-direction: column;
  }
  
  .bpm-controls {
    flex-direction: column;
    gap: 8px;
  }
  
  .bpm-presets {
    justify-content: center;
  }
  
  .metronome-controls {
    flex-direction: column;
  }
  
  .time-signature {
    flex-direction: column;
    gap: 5px;
  }
}
</style>
{% endblock %}

{% block content %}
<div class="guitar-training-container" id="guitarContainer">
  
  <!-- æµ®åŠ¨éŸ³ç¬¦èƒŒæ™¯ -->
  <div class="floating-notes">
    <div class="note" style="top: 10%; left: 10%; animation-delay: 0s;">ğŸ¸</div>
    <div class="note" style="top: 20%; left: 80%; animation-delay: 1s;">ğŸµ</div>
    <div class="note" style="top: 60%; left: 20%; animation-delay: 2s;">ğŸ¶</div>
    <div class="note" style="top: 80%; left: 70%; animation-delay: 3s;">ğŸ¼</div>
    <div class="note" style="top: 30%; left: 60%; animation-delay: 4s;">ğŸ¹</div>
    <div class="note" style="top: 70%; left: 90%; animation-delay: 5s;">ğŸ¤</div>
  </div>

  <div class="guitar-header">
    <h1 class="guitar-title">
      <i class="fas fa-guitar">ğŸ¸</i>
      <span>ä¸æ‘‡å°±æ»š</span>
    </h1>
    <p class="guitar-subtitle">ğŸµ å‰ä»–è®­ç»ƒç³»ç»Ÿ - ä»åˆå­¦è€…åˆ°è¿›é˜¶è€…</p>
  </div>

  <div class="guitar-tools-grid">
    <!-- æ™ºèƒ½è°ƒéŸ³å™¨ -->
    <div class="guitar-card" onclick="toggleTuner()">
      <div class="guitar-icon">
        <i class="fas fa-tune">ğŸšï¸</i>
      </div>
      <h3 class="guitar-title-text">æ™ºèƒ½è°ƒéŸ³å™¨</h3>
      <p class="guitar-description">å®æ—¶éŸ³é¢‘åˆ†æï¼Œç²¾å‡†è°ƒéŸ³ï¼Œæ”¯æŒå¤šç§è°ƒå¼¦æ¨¡å¼</p>
      
      <div class="tuner-container" id="tunerContainer">
        <div class="tuner-display">
          <div class="tuner-note" id="tunerNote">A</div>
          <div class="tuner-frequency" id="tunerFrequency">440 Hz</div>
        </div>
        <div class="tuner-meter">
          <div class="tuner-indicator" id="tunerIndicator"></div>
          <div class="tuner-scale">
            <span>-50</span>
            <span>-25</span>
            <span>0</span>
            <span>+25</span>
            <span>+50</span>
          </div>
        </div>
        <div class="tuner-controls">
          <button class="tuner-btn" onclick="startTuner()">å¼€å§‹è°ƒéŸ³</button>
          <button class="tuner-btn" onclick="stopTuner()">åœæ­¢</button>
          <select class="tuner-btn" id="tuningMode" onchange="changeTuningMode()">
            <option value="standard">æ ‡å‡†è°ƒå¼¦</option>
            <option value="dropd">é™Dè°ƒå¼¦</option>
            <option value="open">å¼€æ”¾è°ƒå¼¦</option>
          </select>
        </div>
      </div>
    </div>

    <!-- å’Œå¼¦è®­ç»ƒå™¨ -->
    <div class="guitar-card" onclick="toggleChordTrainer()">
      <div class="guitar-icon">
        <i class="fas fa-hand-paper">ğŸ¤˜</i>
      </div>
      <h3 class="guitar-title-text">å’Œå¼¦è®­ç»ƒå™¨</h3>
      <p class="guitar-description">3DæŒ‡æ¿æ¼”ç¤ºï¼ŒAIè¯†åˆ«æ­£ç¡®ç‡ï¼Œå’Œå¼¦è½¬æ¢è®­ç»ƒ</p>
      
      <div class="chord-trainer" id="chordTrainer">
        <div class="chord-info">
          <div class="chord-name" id="chordName">C</div>
          <div class="chord-progress">
            <div class="chord-progress-fill" id="chordProgress"></div>
          </div>
        </div>
        <div class="chord-fretboard" id="chordFretboard">
          <!-- 3DæŒ‡æ¿å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
        </div>
        <div class="tuner-controls">
          <button class="tuner-btn" onclick="startChordTraining()">å¼€å§‹è®­ç»ƒ</button>
          <button class="tuner-btn" onclick="nextChord()">ä¸‹ä¸€ä¸ªå’Œå¼¦</button>
          <button class="tuner-btn" onclick="showChordHeatmap()">çƒ­åŠ›å›¾</button>
        </div>
      </div>
    </div>

    <!-- èŠ‚å¥è®­ç»ƒå·¥åŠ -->
    <div class="guitar-card" onclick="toggleRhythmTrainer()">
      <div class="guitar-icon">
        <i class="fas fa-drum">ğŸ¥</i>
      </div>
      <h3 class="guitar-title-text">èŠ‚å¥è®­ç»ƒå·¥åŠ</h3>
      <p class="guitar-description">èŠ‚æ‹å™¨ã€é¼“æœºä¼´å¥ã€èŠ‚å¥æ¸¸æˆï¼Œæå‡èŠ‚å¥æ„Ÿ</p>
      
      <div class="rhythm-trainer" id="rhythmTrainer">
        <div class="metronome">
          <div class="metronome-header">
            <h4>èŠ‚æ‹å™¨æ§åˆ¶</h4>
            <div class="metronome-status" id="metronomeStatus">å·²åœæ­¢</div>
          </div>
          
          <div class="bpm-section">
            <div class="bpm-display" id="bpmDisplay">120</div>
            <div class="bpm-label">BPM</div>
          </div>
          
          <div class="bpm-controls">
            <button class="bpm-btn" onclick="decreaseBPM()" title="å‡å°‘5 BPM">-5</button>
            <button class="bpm-btn" onclick="decreaseBPM(1)" title="å‡å°‘1 BPM">-1</button>
            <input type="range" class="bpm-slider" id="bpmSlider" min="40" max="200" value="120" oninput="updateBPM()">
            <button class="bpm-btn" onclick="increaseBPM(1)" title="å¢åŠ 1 BPM">+1</button>
            <button class="bpm-btn" onclick="increaseBPM()" title="å¢åŠ 5 BPM">+5</button>
          </div>
          
          <div class="bpm-presets">
            <button class="preset-btn" onclick="setBPM(60)">æ…¢é€Ÿ</button>
            <button class="preset-btn" onclick="setBPM(80)">ä¸­æ…¢</button>
            <button class="preset-btn" onclick="setBPM(120)">ä¸­é€Ÿ</button>
            <button class="preset-btn" onclick="setBPM(160)">ä¸­å¿«</button>
            <button class="preset-btn" onclick="setBPM(180)">å¿«é€Ÿ</button>
          </div>
          
          <div class="metronome-controls">
            <button class="tuner-btn primary" onclick="toggleMetronome()" id="metronomeBtn">å¼€å§‹èŠ‚æ‹å™¨</button>
            <button class="tuner-btn" onclick="tapTempo()" id="tapTempoBtn">ç‚¹å‡»èŠ‚æ‹</button>
            <button class="tuner-btn" onclick="resetMetronome()">é‡ç½®</button>
          </div>
          
          <div class="time-signature">
            <label>æ‹å·ï¼š</label>
            <select id="timeSignature" onchange="updateTimeSignature()">
              <option value="4/4">4/4</option>
              <option value="3/4">3/4</option>
              <option value="6/8">6/8</option>
              <option value="2/4">2/4</option>
            </select>
          </div>
        </div>
        
        <div class="tuner-controls">
          <button class="tuner-btn" onclick="selectDrumStyle('rock')">æ‘‡æ»š</button>
          <button class="tuner-btn" onclick="selectDrumStyle('blues')">å¸ƒé²æ–¯</button>
          <button class="tuner-btn" onclick="selectDrumStyle('jazz')">çˆµå£«</button>
          <button class="tuner-btn" onclick="startRhythmGame()">èŠ‚å¥æ¸¸æˆ</button>
        </div>
      </div>
    </div>

    <!-- æ‰“å¡æ—¥å† -->
    <div class="guitar-card checkin-calendar-card">
      <div class="guitar-icon">
        <i class="fas fa-calendar-check">ğŸ“Š</i>
      </div>
      <h3 class="guitar-title-text">ç»ƒä¹ æ‰“å¡</h3>
      <p class="guitar-description">è®°å½•æ¯æ—¥ç»ƒä¹ ï¼Œè¿½è¸ªè¿›æ­¥ï¼Œä¿æŒç»ƒä¹ ä¹ æƒ¯</p>
      
      <div class="checkin-calendar-container">
        <!-- æ—¥å†å¯¼èˆª -->
        <div class="calendar-nav">
          <button class="nav-btn" id="guitarPrevMonth"><i class="fas fa-chevron-left"></i></button>
          <div class="current-month" id="guitarCurrentMonth">2024å¹´1æœˆ</div>
          <button class="nav-btn" id="guitarNextMonth"><i class="fas fa-chevron-right"></i></button>
          <button class="nav-btn today-btn" id="guitarGoToday">ä»Šå¤©</button>
        </div>
        
        <!-- è¿ç»­æ‰“å¡ä¿¡æ¯ -->
        <div class="streak-info">
          <div class="streak-item">
            <i class="fas fa-fire"></i>
            <span>è¿ç»­ <span id="guitarCurrentStreak">0</span> å¤©</span>
          </div>
          <div class="streak-item">
            <i class="fas fa-trophy"></i>
            <span>æœ€é•¿ <span id="guitarLongestStreak">0</span> å¤©</span>
          </div>
        </div>
        
        <!-- æ—¥å†ç½‘æ ¼ -->
        <div class="calendar-grid">
          <div class="calendar-header">
            <div>æ—¥</div>
            <div>ä¸€</div>
            <div>äºŒ</div>
            <div>ä¸‰</div>
            <div>å››</div>
            <div>äº”</div>
            <div>å…­</div>
          </div>
          <div class="calendar-body" id="guitarCalendarBody">
            <!-- æ—¥å†æ—¥æœŸå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>
        
        <!-- æœˆåº¦ç»Ÿè®¡ -->
        <div class="monthly-stats">
          <div class="stat-item">
            <div class="stat-value" id="guitarCompletionRate">0%</div>
            <div class="stat-label">å®Œæˆç‡</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="guitarTotalDuration">0</div>
            <div class="stat-label">æ€»æ—¶é•¿(åˆ†é’Ÿ)</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="guitarCompletedDays">0</div>
            <div class="stat-label">ç»ƒä¹ å¤©æ•°</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ä¸ªæ€§åŒ–ç»ƒä¹ è®¡åˆ’ -->
    <div class="guitar-card" onclick="togglePracticePlan()">
      <div class="guitar-icon">
        <i class="fas fa-calendar-alt">ğŸ“…</i>
      </div>
      <h3 class="guitar-title-text">ç»ƒä¹ è®¡åˆ’</h3>
      <p class="guitar-description">AIç”Ÿæˆä¸ªæ€§åŒ–ç»ƒä¹ è®¡åˆ’ï¼Œè¿½è¸ªè¿›æ­¥æ›²çº¿</p>
      
      <div class="practice-plan" id="practicePlan">
        <div class="plan-header">
          <div class="plan-title">ä¸¤å‘¨ç»ƒä¹ è®¡åˆ’</div>
        </div>
        <ul class="plan-list" id="planList">
          <!-- ç»ƒä¹ è®¡åˆ’å°†åœ¨è¿™é‡Œç”Ÿæˆ -->
        </ul>
        <div class="tuner-controls">
          <button class="tuner-btn" onclick="generatePracticePlan()">ç”Ÿæˆè®¡åˆ’</button>
          <button class="tuner-btn" onclick="updateProgress()">æ›´æ–°è¿›åº¦</button>
          <button class="tuner-btn" onclick="showProgressChart()">è¿›æ­¥æ›²çº¿</button>
        </div>
      </div>
    </div>

    <!-- ç¤¾åŒºæŒ‘æˆ˜ -->
    <div class="guitar-card" onclick="toggleCommunityChallenge()">
      <div class="guitar-icon">
        <i class="fas fa-trophy">ğŸ†</i>
      </div>
      <h3 class="guitar-title-text">ç¤¾åŒºæŒ‘æˆ˜</h3>
      <p class="guitar-description">æ¯å‘¨æŒ‘æˆ˜æ›²ç›®ï¼ŒAIè¯„åˆ†ï¼Œæ’è¡Œæ¦œç«äº‰</p>
      
      <div class="community-challenge" id="communityChallenge">
        <div class="challenge-header">
          <div class="challenge-title">æœ¬å‘¨æŒ‘æˆ˜</div>
        </div>
        <div class="challenge-song">
          <div class="song-title">ã€ŠKnockin' on Heaven's Doorã€‹- å‰å¥éƒ¨åˆ†</div>
          <div class="song-difficulty">éš¾åº¦ï¼šâ˜…â˜…â˜…â˜†â˜†</div>
          <div class="song-progress">
            <div class="song-progress-fill" id="songProgress"></div>
          </div>
        </div>
        <div class="tuner-controls">
          <button class="tuner-btn" onclick="startChallenge()">å¼€å§‹æŒ‘æˆ˜</button>
          <button class="tuner-btn" onclick="uploadVideo()">ä¸Šä¼ è§†é¢‘</button>
          <button class="tuner-btn" onclick="viewLeaderboard()">æ’è¡Œæ¦œ</button>
        </div>
      </div>
    </div>

    <!-- æç®€æ¨¡å¼ -->
    <div class="guitar-card" onclick="enterMinimalMode()">
      <div class="guitar-icon">
        <i class="fas fa-expand">ğŸ”²</i>
      </div>
      <h3 class="guitar-title-text">æç®€æ¨¡å¼</h3>
      <p class="guitar-description">ä¸€é”®è¿›å…¥å…¨å±ç»ƒä¹ ï¼Œä¸“æ³¨æŒ‡æ¿å’ŒèŠ‚æ‹å™¨</p>
    </div>
  </div>
</div>

<script>
// å…¨å±€å˜é‡
let tunerActive = false;
let currentChord = 0;

// å’Œå¼¦åº“
const chords = ['C', 'G', 'Am', 'F', 'D', 'Em', 'Bm', 'A', 'E', 'Dm'];

// è°ƒéŸ³å™¨åŠŸèƒ½
function toggleTuner() {
  const container = document.getElementById('tunerContainer');
  container.style.display = container.style.display === 'none' ? 'block' : 'none';
}

function startTuner() {
  if (!tunerActive) {
    tunerActive = true;

    // æ¨¡æ‹Ÿè°ƒéŸ³å™¨æ•°æ®
    simulateTuner();
  }
}

function stopTuner() {
  tunerActive = false;

}

function simulateTuner() {
  if (!tunerActive) return;
  
  // æ¨¡æ‹ŸéŸ³é«˜æ•°æ®
  const notes = ['E', 'A', 'D', 'G', 'B', 'E'];
  const frequencies = [82.41, 110.00, 146.83, 196.00, 246.94, 329.63];
  const randomNote = Math.floor(Math.random() * notes.length);
  const randomOffset = (Math.random() - 0.5) * 100;
  
  document.getElementById('tunerNote').textContent = notes[randomNote];
  document.getElementById('tunerFrequency').textContent = frequencies[randomNote].toFixed(2) + ' Hz';
  
  // æ›´æ–°æŒ‡ç¤ºå™¨ä½ç½®
  const indicator = document.getElementById('tunerIndicator');
  const position = 50 + (randomOffset / 100) * 40; // 50%ä¸ºä¸­å¿ƒï¼ŒÂ±20%ä¸ºèŒƒå›´
  indicator.style.left = Math.max(10, Math.min(90, position)) + '%';
  
  setTimeout(simulateTuner, 100);
}

function changeTuningMode() {
  const mode = document.getElementById('tuningMode').value;

}

// å’Œå¼¦è®­ç»ƒå™¨åŠŸèƒ½
function toggleChordTrainer() {
  const container = document.getElementById('chordTrainer');
  container.style.display = container.style.display === 'none' ? 'block' : 'none';
}

function startChordTraining() {

  updateChordDisplay();
}

function nextChord() {
  currentChord = (currentChord + 1) % chords.length;
  updateChordDisplay();
}

function updateChordDisplay() {
  const chordName = document.getElementById('chordName');
  const chordProgress = document.getElementById('chordProgress');
  
  chordName.textContent = chords[currentChord];
  
  // æ¨¡æ‹Ÿè¿›åº¦
  const progress = Math.random() * 100;
  chordProgress.style.width = progress + '%';
}

function showChordHeatmap() {

  alert('çƒ­åŠ›å›¾åŠŸèƒ½ï¼šæ˜¾ç¤ºç”¨æˆ·å¸¸æŒ‰é”™çš„ä½ç½®\n\nçº¢è‰²åŒºåŸŸï¼šç»å¸¸æŒ‰é”™\né»„è‰²åŒºåŸŸï¼šå¶å°”æŒ‰é”™\nç»¿è‰²åŒºåŸŸï¼šæŒ‰å¯¹');
}

// èŠ‚å¥è®­ç»ƒå™¨åŠŸèƒ½
function toggleRhythmTrainer() {
  const container = document.getElementById('rhythmTrainer');
  container.style.display = container.style.display === 'none' ? 'block' : 'none';
}

// èŠ‚æ‹å™¨ç›¸å…³å˜é‡
let metronomeActive = false;
let currentBPM = 120;
let metronomeInterval;
let timeSignature = '4/4';
let tapTempoTimes = [];
let beatCount = 0;

function toggleMetronome() {
  if (!metronomeActive) {
    startMetronome();
  } else {
    stopMetronome();
  }
}

function startMetronome() {
  metronomeActive = true;
  document.getElementById('metronomeBtn').textContent = 'åœæ­¢èŠ‚æ‹å™¨';
  document.getElementById('metronomeStatus').textContent = 'è¿è¡Œä¸­';
  document.getElementById('metronomeStatus').style.color = '#4CAF50';

  const interval = 60000 / currentBPM; // æ¯«ç§’
  beatCount = 0;
  metronomeInterval = setInterval(() => {
    playMetronomeClick();
    beatCount++;
    
    // æ ¹æ®æ‹å·é‡ç½®èŠ‚æ‹è®¡æ•°
    const beatsPerBar = parseInt(timeSignature.split('/')[0]);
    if (beatCount >= beatsPerBar) {
      beatCount = 0;
    }
  }, interval);
}

function stopMetronome() {
  metronomeActive = false;
  document.getElementById('metronomeBtn').textContent = 'å¼€å§‹èŠ‚æ‹å™¨';
  document.getElementById('metronomeStatus').textContent = 'å·²åœæ­¢';
  document.getElementById('metronomeStatus').style.color = '#f44336';
  clearInterval(metronomeInterval);
  beatCount = 0;

}

function playMetronomeClick() {
  // åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡æ’­æ”¾èŠ‚æ‹å£°
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
  gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
  
  oscillator.start(audioContext.currentTime);
  oscillator.stop(audioContext.currentTime + 0.1);
}

function updateBPM() {
  currentBPM = parseInt(document.getElementById('bpmSlider').value);
  document.getElementById('bpmDisplay').textContent = currentBPM;
  
  if (metronomeActive) {
    stopMetronome();
    startMetronome();
  }
}

function increaseBPM(increment = 5) {
  currentBPM = Math.min(200, currentBPM + increment);
  document.getElementById('bpmSlider').value = currentBPM;
  document.getElementById('bpmDisplay').textContent = currentBPM;
  
  if (metronomeActive) {
    stopMetronome();
    startMetronome();
  }
}

function decreaseBPM(decrement = 5) {
  currentBPM = Math.max(40, currentBPM - decrement);
  document.getElementById('bpmSlider').value = currentBPM;
  document.getElementById('bpmDisplay').textContent = currentBPM;
  
  if (metronomeActive) {
    stopMetronome();
    startMetronome();
  }
}

function setBPM(bpm) {
  currentBPM = Math.max(40, Math.min(200, bpm));
  document.getElementById('bpmSlider').value = currentBPM;
  document.getElementById('bpmDisplay').textContent = currentBPM;
  
  if (metronomeActive) {
    stopMetronome();
    startMetronome();
  }

}

function tapTempo() {
  const now = Date.now();
  tapTempoTimes.push(now);
  
  // åªä¿ç•™æœ€è¿‘4æ¬¡ç‚¹å‡»
  if (tapTempoTimes.length > 4) {
    tapTempoTimes.shift();
  }
  
  // è®¡ç®—å¹³å‡é—´éš”
  if (tapTempoTimes.length >= 2) {
    const intervals = [];
    for (let i = 1; i < tapTempoTimes.length; i++) {
      intervals.push(tapTempoTimes[i] - tapTempoTimes[i-1]);
    }
    
    const avgInterval = intervals.reduce((a, b) => a + b, 0) / intervals.length;
    const calculatedBPM = Math.round(60000 / avgInterval);
    
    // é™åˆ¶BPMèŒƒå›´
    const newBPM = Math.max(40, Math.min(200, calculatedBPM));
    setBPM(newBPM);

  }
  
  // 3ç§’åæ¸…é™¤ç‚¹å‡»è®°å½•
  setTimeout(() => {
    tapTempoTimes = [];
  }, 3000);
}

function resetMetronome() {
  stopMetronome();
  setBPM(120);
  timeSignature = '4/4';
  document.getElementById('timeSignature').value = '4/4';
  tapTempoTimes = [];
  beatCount = 0;

}

function updateTimeSignature() {
  timeSignature = document.getElementById('timeSignature').value;

  if (metronomeActive) {
    stopMetronome();
    startMetronome();
  }
}

function selectDrumStyle(style) {

  const styles = {
    'rock': 'æ‘‡æ»šé£æ ¼ï¼šå¼ºåŠ›çš„4/4æ‹ï¼Œé€‚åˆç»ƒä¹ å¼ºåŠ›å’Œå¼¦',
    'blues': 'å¸ƒé²æ–¯é£æ ¼ï¼š12å°èŠ‚å¸ƒé²æ–¯ï¼Œé€‚åˆç»ƒä¹ è“è°ƒéŸ³é˜¶',
    'jazz': 'çˆµå£«é£æ ¼ï¼šå¤æ‚çš„èŠ‚å¥å‹ï¼Œé€‚åˆç»ƒä¹ çˆµå£«å’Œå¼¦'
  };
  alert(styles[style] || 'æœªçŸ¥é£æ ¼');
}

function startRhythmGame() {

  alert('èŠ‚å¥æ¸¸æˆï¼š\n\néŸ³ç¬¦ä¼šä»ä¸Šæ–¹è½ä¸‹\nç‚¹å‡»å±å¹•åœ¨æ­£ç¡®æ—¶æœºå‡»ä¸­éŸ³ç¬¦\nç»ƒä¹ èŠ‚å¥æ„Ÿå’Œæ—¶æœºæŠŠæ¡');
}

// ç»ƒä¹ è®¡åˆ’åŠŸèƒ½
function togglePracticePlan() {
  const container = document.getElementById('practicePlan');
  container.style.display = container.style.display === 'none' ? 'block' : 'none';
}

function generatePracticePlan() {
  const planList = document.getElementById('planList');
  const plans = [
    { day: 'ç¬¬1-3å¤©', content: 'Em, C, Gå’Œå¼¦è½¬æ¢ï¼ˆ60BPMâ†’80BPMï¼‰' },
    { day: 'ç¬¬4å¤©', content: 'åŠ å…¥Få’Œå¼¦ & èŠ‚å¥å˜åŒ–ç»ƒä¹ ' },
    { day: 'ç¬¬5-7å¤©', content: 'ã€ŠKnockin\' on Heaven\'s Doorã€‹æ®µè½ç»ƒä¹ ' },
    { day: 'ç¬¬8-10å¤©', content: 'Bm, Dmå’Œå¼¦ç»ƒä¹  & æ‰«å¼¦æŠ€å·§' },
    { day: 'ç¬¬11-14å¤©', content: 'å®Œæ•´æ­Œæ›²ç»ƒä¹  & å½•éŸ³è¯„ä¼°' }
  ];
  
  planList.innerHTML = '';
  plans.forEach(plan => {
    const li = document.createElement('li');
    li.className = 'plan-item';
    li.innerHTML = `
      <div class="plan-day">${plan.day}</div>
      <div class="plan-content">${plan.content}</div>
    `;
    planList.appendChild(li);
  });

}

function updateProgress() {

  alert('è¿›åº¦æ›´æ–°ï¼š\n\nä»Šæ—¥ç»ƒä¹ æ—¶é—´ï¼š45åˆ†é’Ÿ\nå’Œå¼¦å‡†ç¡®ç‡ï¼š78%\nèŠ‚å¥å‡†ç¡®ç‡ï¼š85%\nå»ºè®®ï¼šåŠ å¼ºFå’Œå¼¦ç»ƒä¹ ');
}

function showProgressChart() {

  alert('è¿›æ­¥æ›²çº¿å›¾ï¼š\n\næ˜¾ç¤ºè¿‡å»30å¤©çš„ç»ƒä¹ æ•°æ®\nåŒ…æ‹¬ï¼š\n- ç»ƒä¹ æ—¶é•¿\n- å’Œå¼¦å‡†ç¡®ç‡\n- èŠ‚å¥å‡†ç¡®ç‡\n- è–„å¼±ç‚¹é¢„è­¦');
}

// ç¤¾åŒºæŒ‘æˆ˜åŠŸèƒ½
function toggleCommunityChallenge() {
  const container = document.getElementById('communityChallenge');
  container.style.display = container.style.display === 'none' ? 'block' : 'none';
}

function startChallenge() {

  alert('æŒ‘æˆ˜å¼€å§‹ï¼š\n\næ›²ç›®ï¼šã€ŠKnockin\' on Heaven\'s Doorã€‹å‰å¥\næ—¶é•¿ï¼š15ç§’\nè¦æ±‚ï¼šå‡†ç¡®å¼¹å¥å’Œå¼¦è¿›è¡Œ\nå½•åˆ¶è§†é¢‘ä¸Šä¼ å‚ä¸è¯„åˆ†');
}

function uploadVideo() {

  alert('è§†é¢‘ä¸Šä¼ ï¼š\n\n1. å½•åˆ¶15ç§’ç»ƒä¹ ç‰‡æ®µ\n2. ç¡®ä¿éŸ³è´¨æ¸…æ™°\n3. AIå°†è‡ªåŠ¨è¯„åˆ†ï¼š\n   - èŠ‚å¥å‡†ç¡®åº¦\n   - å’Œå¼¦æ¸…æ™°åº¦\n   - æ•´ä½“æµç•…åº¦');
}

function viewLeaderboard() {

  alert('æ’è¡Œæ¦œï¼š\n\nğŸ† ç¬¬ä¸€åï¼šå¼ ä¸‰ - 95åˆ†\nğŸ¥ˆ ç¬¬äºŒåï¼šæå›› - 92åˆ†\nğŸ¥‰ ç¬¬ä¸‰åï¼šç‹äº” - 89åˆ†\n\nä½ çš„æ’åï¼šç¬¬15å - 78åˆ†');
}

// æç®€æ¨¡å¼
function enterMinimalMode() {

  // è¿›å…¥å…¨å±æ¨¡å¼
  if (document.documentElement.requestFullscreen) {
    document.documentElement.requestFullscreen();
  }
  
  // åˆ›å»ºæç®€æ¨¡å¼ç•Œé¢
  const minimalMode = document.createElement('div');
  minimalMode.id = 'minimalMode';
  minimalMode.innerHTML = `
    <div class="minimal-mode-overlay">
      <div class="minimal-mode-content">
        <div class="minimal-fretboard" id="minimalFretboard">
          <!-- æç®€æŒ‡æ¿ -->
          <div class="minimal-fretboard-display">
            <div class="fretboard-strings">
              <div class="string"></div>
              <div class="string"></div>
              <div class="string"></div>
              <div class="string"></div>
              <div class="string"></div>
              <div class="string"></div>
            </div>
            <div class="fretboard-frets">
              <div class="fret"></div>
              <div class="fret"></div>
              <div class="fret"></div>
              <div class="fret"></div>
              <div class="fret"></div>
            </div>
          </div>
        </div>
        <div class="minimal-metronome">
          <div class="bpm-display" id="minimalBPM">120</div>
          <button class="minimal-btn" onclick="toggleMinimalMetronome()">èŠ‚æ‹å™¨</button>
        </div>
        <button class="minimal-exit-btn" onclick="exitMinimalMode()">é€€å‡º</button>
      </div>
    </div>
  `;
  
  // æ·»åŠ æç®€æ¨¡å¼æ ·å¼
  const style = document.createElement('style');
  style.textContent = `
    .minimal-mode-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .minimal-mode-content {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
    }
    
    .minimal-fretboard {
      width: 80%;
      height: 60%;
      background: #333;
      border: 2px solid #666;
      border-radius: 10px;
      margin-bottom: 20px;
      position: relative;
    }
    
    .minimal-fretboard-display {
      width: 100%;
      height: 100%;
      position: relative;
    }
    
    .fretboard-strings {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .string {
      flex: 1;
      border-bottom: 1px solid #666;
    }
    
    .fretboard-frets {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
    }
    
    .fret {
      flex: 1;
      border-right: 2px solid #666;
    }
    
    .minimal-metronome {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .bpm-display {
      font-size: 2rem;
      font-weight: bold;
    }
    
    .minimal-btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
    
    .minimal-exit-btn {
      background: #f44336;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
  `;
  
  document.head.appendChild(style);
  document.body.appendChild(minimalMode);
}

// é€€å‡ºæç®€æ¨¡å¼
function exitMinimalMode() {
  const minimalMode = document.getElementById('minimalMode');
  if (minimalMode) {
    minimalMode.remove();
  }
  
  if (document.fullscreenElement) {
    document.exitFullscreen();
  }
}

// æç®€æ¨¡å¼èŠ‚æ‹å™¨
let minimalMetronomeActive = false;
let minimalMetronomeInterval;

function toggleMinimalMetronome() {
  if (minimalMetronomeActive) {
    stopMinimalMetronome();
  } else {
    startMinimalMetronome();
  }
}

function startMinimalMetronome() {
  const bpmDisplay = document.getElementById('minimalBPM');
  const bpm = parseInt(bpmDisplay.textContent);
  const interval = 60000 / bpm;
  
  minimalMetronomeInterval = setInterval(() => {
    playMetronomeClick();
  }, interval);
  
  minimalMetronomeActive = true;
}

function stopMinimalMetronome() {
  if (minimalMetronomeInterval) {
    clearInterval(minimalMetronomeInterval);
    minimalMetronomeActive = false;
  }
}

// é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {

  // åˆå§‹åŒ–ç»ƒä¹ è®¡åˆ’
  generatePracticePlan();
  
  // åˆå§‹åŒ–è¿›åº¦
  document.getElementById('songProgress').style.width = '65%';
  
  // åˆå§‹åŒ–å‰ä»–æ‰“å¡æ—¥å†
  new GuitarCheckInCalendar();
});

// å‰ä»–æ‰“å¡æ—¥å†åŠŸèƒ½
class GuitarCheckInCalendar {
  constructor() {
    this.currentDate = new Date();
    this.currentYear = this.currentDate.getFullYear();
    this.currentMonth = this.currentDate.getMonth();
    this.calendarData = {};
    this.streak = { current: 0, longest: 0 };
    this.monthlyStats = {};
    
    this.init();
  }
  
  async init() {
    await this.loadCalendarData();
    this.renderCalendar();
    this.bindEvents();
    this.updateStats();
  }
  
  async loadCalendarData() {
    try {
      const response = await fetch(`/tools/api/checkin/calendar/?type=guitar&year=${this.currentYear}&month=${this.currentMonth + 1}`);
      const data = await response.json();
      
      if (data.success) {
        this.calendarData = data.calendar_data;
        this.streak = data.streak;
        this.monthlyStats = data.monthly_stats;
      }
    } catch (error) {
      console.error('åŠ è½½å‰ä»–æ—¥å†æ•°æ®å¤±è´¥:', error);
    }
  }
  
  renderCalendar() {
    const firstDay = new Date(this.currentYear, this.currentMonth, 1);
    const lastDay = new Date(this.currentYear, this.currentMonth + 1, 0);
    const startDate = new Date(firstDay);
    startDate.setDate(startDate.getDate() - firstDay.getDay());
    
    const calendarBody = document.getElementById('guitarCalendarBody');
    calendarBody.innerHTML = '';
    
    // æ›´æ–°æœˆä»½æ˜¾ç¤º
    document.getElementById('guitarCurrentMonth').textContent = 
      `${this.currentYear}å¹´${this.currentMonth + 1}æœˆ`;
    
    // æ›´æ–°è¿ç»­æ‰“å¡ä¿¡æ¯
    document.getElementById('guitarCurrentStreak').textContent = this.streak.current;
    document.getElementById('guitarLongestStreak').textContent = this.streak.longest;
    
    // ç”Ÿæˆæ—¥å†ç½‘æ ¼
    for (let i = 0; i < 42; i++) {
      const date = new Date(startDate);
      date.setDate(startDate.getDate() + i);
      
      const dayElement = document.createElement('div');
      dayElement.className = 'calendar-day';
      
      const dateStr = date.toISOString().split('T')[0];
      const isCurrentMonth = date.getMonth() === this.currentMonth;
      const isToday = date.toDateString() === new Date().toDateString();
      const checkinData = this.calendarData[dateStr];
      
      if (!isCurrentMonth) {
        dayElement.classList.add('other-month');
      }
      
      if (isToday) {
        dayElement.classList.add('today');
      }
      
      if (checkinData) {
        dayElement.classList.add('has-checkin');
        if (checkinData.status === 'completed') {
          dayElement.classList.add('completed');
        } else if (checkinData.status === 'rest') {
          dayElement.classList.add('rest');
        }
      }
      
      dayElement.textContent = date.getDate();
      dayElement.setAttribute('data-date', dateStr);
      
      dayElement.addEventListener('click', () => this.handleDayClick(dateStr, checkinData));
      
      calendarBody.appendChild(dayElement);
    }
  }
  
  async handleDayClick(dateStr, checkinData) {
    const clickedDate = new Date(dateStr);
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºæœªæ¥æ—¥æœŸ
    if (clickedDate > today) {
      this.showNotification('ä¸èƒ½ä¸ºæœªæ¥æ—¥æœŸæ‰“å¡', 'error');
      return;
    }
    
    if (checkinData) {
      // æ˜¾ç¤ºæ‰“å¡è¯¦æƒ…
      this.showCheckinDetail(dateStr, checkinData);
    } else {
      // æ£€æŸ¥æ˜¯å¦ä¸ºè¿‡å»çš„æ—¥æœŸ
      if (clickedDate < today) {
        // æ˜¾ç¤ºäºŒæ¬¡ç¡®è®¤å¯¹è¯æ¡†
        this.showPastDateConfirmation(dateStr);
      } else {
        // ä»Šå¤©çš„æ—¥æœŸï¼Œç›´æ¥æ˜¾ç¤ºæ‰“å¡è¡¨å•
        this.showCheckinForm(dateStr);
      }
    }
  }

  showPastDateConfirmation(dateStr) {
    const confirmation = `
      <div class="checkin-modal">
        <div class="checkin-modal-content">
          <h3>ç¡®è®¤è¡¥æ‰“å¡</h3>
          <div class="confirmation-message">
            <i class="fas fa-exclamation-triangle" style="color: #ff6b35; font-size: 2rem; margin-bottom: 15px;"></i>
            <p>æ‚¨æ­£åœ¨ä¸º <strong>${dateStr}</strong> è¡¥æ‰“å¡ï¼Œè¿™æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸã€‚</p>
            <p>è¯·ç¡®è®¤æ‚¨ç¡®å®åœ¨è¿™ä¸€å¤©è¿›è¡Œäº†å‰ä»–ç»ƒä¹ ã€‚</p>
          </div>
          <div class="form-actions">
            <button class="btn-cancel">å–æ¶ˆ</button>
            <button class="btn-confirm">ç¡®è®¤è¡¥æ‰“å¡</button>
          </div>
        </div>
      </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', confirmation);
    
    const modal = document.querySelector('.checkin-modal');
    
    modal.querySelector('.btn-cancel').addEventListener('click', () => {
      modal.remove();
    });
    
    modal.querySelector('.btn-confirm').addEventListener('click', () => {
      modal.remove();
      this.showCheckinForm(dateStr);
    });
    
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.remove();
      }
    });
  }

  showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.innerHTML = `
      <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
      <span>${message}</span>
    `;
    
    Object.assign(notification.style, {
      position: 'fixed',
      top: '20px',
      right: '20px',
      padding: '12px 20px',
      borderRadius: '6px',
      color: 'white',
      fontSize: '14px',
      fontWeight: '500',
      zIndex: '10000',
      display: 'flex',
      alignItems: 'center',
      gap: '8px',
      minWidth: '250px',
      boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
      backgroundColor: type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3',
      animation: 'slideInRight 0.3s ease-out'
    });
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOutRight 0.3s ease-in';
      setTimeout(() => {
        if (notification.parentNode) {
          notification.parentNode.removeChild(notification);
        }
      }, 300);
    }, 3000);
  }
  
  showCheckinForm(dateStr) {
    const form = `
      <div class="checkin-modal">
        <div class="checkin-modal-content">
          <h3>æ·»åŠ å‰ä»–ç»ƒä¹ æ‰“å¡ - ${dateStr}</h3>
          <form id="guitarCheckinForm">
            <div class="form-group">
              <label>ç»ƒä¹ ç±»å‹</label>
              <select name="practice_type" required>
                <option value="chords">å’Œå¼¦ç»ƒä¹ </option>
                <option value="scales">éŸ³é˜¶ç»ƒä¹ </option>
                <option value="songs">æ­Œæ›²ç»ƒä¹ </option>
                <option value="theory">ä¹ç†å­¦ä¹ </option>
                <option value="ear_training">å¬åŠ›è®­ç»ƒ</option>
                <option value="other">å…¶ä»–</option>
              </select>
            </div>
            <div class="form-group">
              <label>ç»ƒä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰</label>
              <input type="number" name="duration" min="1" max="300" required>
            </div>
            <div class="form-group">
              <label>ç»ƒä¹ å¼ºåº¦</label>
              <select name="intensity" required>
                <option value="low">ä½</option>
                <option value="medium">ä¸­</option>
                <option value="high">é«˜</option>
              </select>
            </div>
            <div class="form-group">
              <label>ç»ƒä¹ æ›²ç›®</label>
              <input type="text" name="song_name" placeholder="å¦‚ï¼šKnockin' on Heaven's Door">
            </div>
            <div class="form-group">
              <label>ç»ƒä¹ ç¬”è®°</label>
              <textarea name="notes" rows="3" placeholder="è®°å½•ä»Šå¤©çš„ç»ƒä¹ å¿ƒå¾—..."></textarea>
            </div>
            <div class="form-actions">
              <button type="button" class="btn-cancel">å–æ¶ˆ</button>
              <button type="submit" class="btn-submit">ä¿å­˜</button>
            </div>
          </form>
        </div>
      </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', form);
    
    const modal = document.querySelector('.checkin-modal');
    const formElement = document.getElementById('guitarCheckinForm');
    
    formElement.addEventListener('submit', (e) => {
      e.preventDefault();
      this.submitCheckin(dateStr, formElement);
    });
    
    modal.querySelector('.btn-cancel').addEventListener('click', () => {
      modal.remove();
    });
    
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.remove();
      }
    });
  }
  
  showCheckinDetail(dateStr, checkinData) {
    const detail = `
      <div class="checkin-modal">
        <div class="checkin-modal-content">
          <h3>å‰ä»–ç»ƒä¹ æ‰“å¡è¯¦æƒ… - ${dateStr}</h3>
          <div class="checkin-detail">
            <p><strong>çŠ¶æ€:</strong> ${checkinData.status === 'completed' ? 'å·²å®Œæˆ' : 'ä¼‘æ¯æ—¥'}</p>
            ${checkinData.detail ? `
              <p><strong>ç»ƒä¹ ç±»å‹:</strong> ${this.getPracticeTypeName(checkinData.detail.practice_type)}</p>
              <p><strong>ç»ƒä¹ æ—¶é•¿:</strong> ${checkinData.detail.duration} åˆ†é’Ÿ</p>
              <p><strong>ç»ƒä¹ å¼ºåº¦:</strong> ${this.getIntensityName(checkinData.detail.intensity)}</p>
              <p><strong>ç»ƒä¹ æ›²ç›®:</strong> ${checkinData.detail.song_name || 'æ— '}</p>
              <p><strong>ç»ƒä¹ ç¬”è®°:</strong> ${checkinData.detail.notes || 'æ— '}</p>
            ` : ''}
          </div>
          <div class="form-actions">
            <button class="btn-cancel">å…³é—­</button>
          </div>
        </div>
      </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', detail);
    
    const modal = document.querySelector('.checkin-modal');
    
    modal.querySelector('.btn-cancel').addEventListener('click', () => {
      modal.remove();
    });
    
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.remove();
      }
    });
  }
  
  async submitCheckin(dateStr, form) {
    const formData = new FormData(form);
    const data = {
      type: 'guitar',
      date: dateStr,
      status: 'completed',
      detail: {
        practice_type: formData.get('practice_type'),
        duration: parseInt(formData.get('duration')),
        intensity: formData.get('intensity'),
        song_name: formData.get('song_name'),
        notes: formData.get('notes')
      }
    };
    
    try {
      const response = await fetch('/tools/api/checkin/add/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        },
        body: JSON.stringify(data)
      });
      
      const result = await response.json();
      
      if (result.success) {
        await this.loadCalendarData();
        this.renderCalendar();
        this.updateStats();
        document.querySelector('.checkin-modal').remove();
        alert('ç»ƒä¹ æ‰“å¡æˆåŠŸï¼ğŸ¸');
      } else {
        alert('æ‰“å¡å¤±è´¥: ' + result.error);
      }
    } catch (error) {
      console.error('æäº¤å‰ä»–æ‰“å¡å¤±è´¥:', error);
      alert('æ‰“å¡å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
  }
  
  async deleteCheckin(dateStr) {
    try {
      const response = await fetch(`/tools/api/checkin/delete/${this.getCheckinId(dateStr)}/`, {
        method: 'DELETE',
        headers: {
          'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        }
      });
      
      const result = await response.json();
      
      if (result.success) {
        await this.loadCalendarData();
        this.renderCalendar();
        this.updateStats();
        alert('åˆ é™¤æˆåŠŸ');
      } else {
        alert('åˆ é™¤å¤±è´¥: ' + result.error);
      }
    } catch (error) {
      console.error('åˆ é™¤å‰ä»–æ‰“å¡å¤±è´¥:', error);
      alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
  }
  
  getCheckinId(dateStr) {
    // è¿™é‡Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè·å–checkin_id
    return 1; // ä¸´æ—¶è¿”å›
  }
  
  getPracticeTypeName(type) {
    const types = {
      'chords': 'å’Œå¼¦ç»ƒä¹ ',
      'scales': 'éŸ³é˜¶ç»ƒä¹ ',
      'songs': 'æ­Œæ›²ç»ƒä¹ ',
      'theory': 'ä¹ç†å­¦ä¹ ',
      'ear_training': 'å¬åŠ›è®­ç»ƒ',
      'other': 'å…¶ä»–'
    };
    return types[type] || type;
  }
  
  getIntensityName(intensity) {
    const intensities = {
      'low': 'ä½',
      'medium': 'ä¸­',
      'high': 'é«˜'
    };
    return intensities[intensity] || intensity;
  }
  
  updateStats() {
    document.getElementById('guitarCompletionRate').textContent = 
      `${this.monthlyStats.completion_rate || 0}%`;
    document.getElementById('guitarTotalDuration').textContent = 
      this.monthlyStats.total_duration || 0;
    document.getElementById('guitarCompletedDays').textContent = 
      this.monthlyStats.completed_days || 0;
  }
  
  bindEvents() {
    document.getElementById('guitarPrevMonth').addEventListener('click', () => {
      this.currentMonth--;
      if (this.currentMonth < 0) {
        this.currentMonth = 11;
        this.currentYear--;
      }
      this.loadCalendarData().then(() => this.renderCalendar());
    });
    
    document.getElementById('guitarNextMonth').addEventListener('click', () => {
      this.currentMonth++;
      if (this.currentMonth > 11) {
        this.currentMonth = 0;
        this.currentYear++;
      }
      this.loadCalendarData().then(() => this.renderCalendar());
    });
    
    document.getElementById('guitarGoToday').addEventListener('click', () => {
      this.currentDate = new Date();
      this.currentYear = this.currentDate.getFullYear();
      this.currentMonth = this.currentDate.getMonth();
      this.loadCalendarData().then(() => this.renderCalendar());
    });
  }
}

// æ·»åŠ åŠ¨ç”»å’Œæ ·å¼
const style = document.createElement('style');
style.textContent = `
  @keyframes slideInRight {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
  
  @keyframes slideOutRight {
    from { transform: translateX(0); opacity: 1; }
    to { transform: translateX(100%); opacity: 0; }
  }
  
  /* ç¡®è®¤å¯¹è¯æ¡†æ ·å¼ */
  .confirmation-message {
    text-align: center;
    margin: 20px 0;
    padding: 20px;
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
  }
  
  .confirmation-message p {
    margin: 10px 0;
    color: #856404;
    line-height: 1.5;
  }
  
  .confirmation-message strong {
    color: #ff6b35;
  }
  
  .btn-confirm {
    background: #ff6b35;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
  }
  
  .btn-confirm:hover {
    background: #e55a2b;
    transform: translateY(-2px);
  }
  
  /* é€šçŸ¥æ ·å¼ */
  .notification {
    animation: slideInRight 0.3s ease-out;
  }
  
  .notification.notification-error {
    background-color: #f44336;
  }
  
  .notification.notification-success {
    background-color: #4CAF50;
  }
  
  .notification.notification-info {
    background-color: #2196F3;
  }
`;
document.head.appendChild(style);

// ä¸»é¢˜éŸ³ä¹åŠ è½½å‡½æ•°ï¼ˆå¦‚æœbase.htmlä¸­æ²¡æœ‰å®šä¹‰ï¼‰
if (typeof loadThemeMusic === 'undefined') {
  async function loadThemeMusic(theme) {
    try {
      const response = await fetch(`/tools/api/music/?mode=work&action=random`);
      const data = await response.json();
      
      if (data.success && data.music_url) {
        // åˆ›å»ºéŸ³é¢‘å…ƒç´ 
        const audio = document.createElement('audio');
        audio.src = data.music_url;
        audio.loop = true;
        audio.volume = 0.3;
        audio.id = 'themeMusic';
        
        // ç§»é™¤æ—§çš„éŸ³é¢‘å…ƒç´ 
        const oldAudio = document.getElementById('themeMusic');
        if (oldAudio) {
          oldAudio.remove();
        }
        
        document.body.appendChild(audio);
        
        // è‡ªåŠ¨æ’­æ”¾ï¼ˆéœ€è¦ç”¨æˆ·äº¤äº’ï¼‰
        audio.play().catch(error => {

        });
      }
    } catch (error) {

    }
  }
}

// ç¡®ä¿æ‰€æœ‰å‡½æ•°éƒ½å·²å®šä¹‰åˆ°å…¨å±€ä½œç”¨åŸŸ
(function() {
  // å°†æ‰€æœ‰å‡½æ•°ç»‘å®šåˆ°windowå¯¹è±¡ï¼Œç¡®ä¿å…¨å±€å¯è®¿é—®
  const functions = {
    toggleTuner,
    toggleChordTrainer,
    toggleRhythmTrainer,
    togglePracticePlan,
    toggleCommunityChallenge,
    enterMinimalMode,
    startTuner,
    stopTuner,
    changeTuningMode,
    startChordTraining,
    nextChord,
    showChordHeatmap,
    toggleMetronome,
    startMetronome,
    stopMetronome,
    updateBPM,
    increaseBPM,
    decreaseBPM,
    setBPM,
    tapTempo,
    resetMetronome,
    updateTimeSignature,
    selectDrumStyle,
    startRhythmGame,
    generatePracticePlan,
    updateProgress,
    showProgressChart,
    startChallenge,
    uploadVideo,
    viewLeaderboard,
    exitMinimalMode,
    toggleMinimalMetronome,
    startMinimalMetronome,
    stopMinimalMetronome
  };
  
  // å°†å‡½æ•°ç»‘å®šåˆ°windowå¯¹è±¡
  Object.keys(functions).forEach(functionName => {
    if (typeof functions[functionName] === 'function') {
      window[functionName] = functions[functionName];
    }
  });
})();
</script>
{% endblock %}
