{% extends 'base.html' %}
{% load static %}

{% block tool_title_inner %}ç‹‚æš´æ¨¡å¼{% endblock %}
{% block tool_title_display %}ç‹‚æš´æ¨¡å¼{% endblock %}

{% block extra_css %}
<style>


/* è®­ç»ƒæ¨¡å¼ç‚¹å‡»è®¡æ•°å™¨ */
.training-mode-click-counter {
  position: fixed;
  top: 20px;
  right: 20px;
  background: rgba(0, 0, 0, 0.8);
  color: #ff4444;
  padding: 10px 15px;
  border-radius: 8px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  z-index: 1000;
  border: 1px solid #ff4444;
  display: none;
}

.training-mode-click-counter.show {
  display: block;
}

/* ç‹‚èºç—‡ç­‰çº§æŒ‡ç¤ºå™¨ */
.mania-level-indicator {
  position: fixed;
  top: 60px;
  right: 20px;
  background: rgba(0, 0, 0, 0.8);
  color: #ff0000;
  padding: 10px 15px;
  border-radius: 8px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  z-index: 1000;
  border: 1px solid #ff0000;
  display: none;
}

.mania-level-indicator.show {
  display: block;
}

.mania-level-bar {
  width: 100px;
  height: 8px;
  background: #333;
  border-radius: 4px;
  margin-top: 5px;
  overflow: hidden;
}

.mania-level-fill {
  height: 100%;
  background: linear-gradient(90deg, #ff0000, #ff6600, #ffff00);
  transition: width 0.3s ease;
}
.rage-container {
  min-height: 100vh;
  background: #0a0a0a;
  color: #ffffff;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
}

.rage-container::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: 
    radial-gradient(circle at 20% 80%, rgba(255, 68, 68, 0.15) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(255, 107, 53, 0.15) 0%, transparent 50%),
    radial-gradient(circle at 40% 40%, rgba(255, 215, 0, 0.1) 0%, transparent 50%);
  z-index: -1;
  /* å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œåªåœ¨ç”¨æˆ·äº¤äº’æ—¶æ’­æ”¾ */
  animation: none;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
}

/* åªåœ¨ç”¨æˆ·æ‚¬åœæ—¶æ’­æ”¾åŠ¨ç”» */
.rage-container:hover::before {
  animation: ragePulse 3s ease-in-out infinite;
}

@keyframes ragePulse {
  0%, 100% { 
    transform: scale(1) rotate(0deg);
    opacity: 0.8;
  }
  50% { 
    transform: scale(1.02) rotate(0.5deg);
    opacity: 1;
  }
}

/* æµ®åŠ¨ç«ç„°åŠ¨ç”» */
.floating-fire {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
}

.fire {
  position: absolute;
  font-size: 2rem;
  /* å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œåªåœ¨ç”¨æˆ·äº¤äº’æ—¶æ’­æ”¾ */
  animation: none;
  opacity: 0.7;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
}

/* åªåœ¨ç”¨æˆ·æ‚¬åœæ—¶æ’­æ”¾åŠ¨ç”» */
.floating-fire:hover .fire {
  animation: floatFire 4s ease-in-out infinite;
}

.fire:nth-child(1) { top: 15%; left: 10%; }
.fire:nth-child(2) { top: 25%; right: 20%; }
.fire:nth-child(3) { bottom: 35%; left: 15%; }
.fire:nth-child(4) { bottom: 20%; right: 15%; }
.fire:nth-child(5) { top: 55%; left: 8%; }
.fire:nth-child(6) { top: 65%; right: 8%; }

@keyframes floatFire {
  0%, 100% { 
    transform: translateY(0px) rotate(0deg) scale(1);
    opacity: 0.7;
  }
  25% { 
    transform: translateY(-15px) rotate(45deg) scale(1.1);
    opacity: 1;
  }
  50% { 
    transform: translateY(-8px) rotate(90deg) scale(0.9);
    opacity: 0.5;
  }
  75% { 
    transform: translateY(-20px) rotate(135deg) scale(1.2);
    opacity: 0.9;
  }
}

.rage-header {
  text-align: center;
  margin-bottom: 4rem;
  padding: 3rem 0;
  position: relative;
  z-index: 1;
}

.rage-title {
  color: #ff4444;
  font-size: 3.5rem;
  font-weight: 900;
  margin-bottom: 1rem;
  text-shadow: 0 0 20px rgba(255, 68, 68, 0.5);
  letter-spacing: 2px;
  text-transform: uppercase;
  /* å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œåªåœ¨ç”¨æˆ·äº¤äº’æ—¶æ’­æ”¾ */
  animation: none;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
}

/* åªåœ¨ç”¨æˆ·æ‚¬åœæ—¶æ’­æ”¾åŠ¨ç”» */
.rage-container:hover .rage-title {
  animation: titleShake 2s ease-in-out infinite;
}

@keyframes titleShake {
  0%, 100% { transform: translateX(0px); }
  25% { transform: translateX(-1px); }
  75% { transform: translateX(1px); }
}

.rage-subtitle {
  font-size: 1.2rem;
  color: rgba(255, 255, 255, 0.8);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 1px;
  /* å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œåªåœ¨ç”¨æˆ·äº¤äº’æ—¶æ’­æ”¾ */
  animation: none;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
}

/* åªåœ¨ç”¨æˆ·æ‚¬åœæ—¶æ’­æ”¾åŠ¨ç”» */
.rage-container:hover .rage-subtitle {
  animation: subtitlePulse 3s ease-in-out infinite;
}

@keyframes subtitlePulse {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
}

.rage-tools-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 2.5rem;
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
  z-index: 1;
  justify-items: center;
}

.training-card {
  background: linear-gradient(135deg, rgba(26, 26, 26, 0.9) 0%, rgba(255, 68, 68, 0.1) 100%);
  border: 2px solid rgba(255, 68, 68, 0.3);
  border-radius: 8px;
  box-shadow: 0 8px 32px rgba(255, 68, 68, 0.2);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
  padding: 24px;
  text-align: center;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.training-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(135deg, #ff4444 0%, #ff6b35 50%, #ffd700 100%);
  transform: scaleX(0);
  transition: transform 0.3s ease;
}

.training-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 68, 68, 0.1), transparent);
  transition: left 0.8s ease;
}

.training-card:hover::after {
  transform: scaleX(1);
}

.training-card:hover::before {
  left: 100%;
}

.training-card:hover {
  box-shadow: 0 12px 48px rgba(255, 68, 68, 0.4);
  transform: translateY(-4px) scale(1.02);
  border-color: #ff4444;
}

.training-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  color: #ff4444;
  text-shadow: 0 0 20px rgba(255, 68, 68, 0.5);
  animation: rageBounce 2s ease-in-out infinite;
}

@keyframes rageBounce {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-10px) scale(1.1); }
}

.training-title {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
  color: #ffffff;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.training-description {
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.7);
  line-height: 1.6;
  margin-bottom: 1.5rem;
}

.training-btn {
  background: linear-gradient(135deg, #ff4444 0%, #ff6b35 100%);
  color: #000000;
  border: none;
  padding: 0.8rem 1.5rem;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 1px;
  box-shadow: 0 5px 15px rgba(255, 68, 68, 0.4);
  position: relative;
  overflow: hidden;
}

.training-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s ease;
}

.training-btn:hover::before {
  left: 100%;
}

.training-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 25px rgba(255, 68, 68, 0.6);
}

/* æ¬²æœ›ä»ªè¡¨ç›˜æ ·å¼ */
.desire-display {
  background: rgba(255, 68, 68, 0.1);
  border: 2px solid rgba(255, 68, 68, 0.3);
  border-radius: 8px;
  padding: 1rem;
  margin: 1rem 0;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
  line-height: 1.4;
  white-space: pre-line;
  text-align: left;
}

.desire-bar {
  color: #ff4444;
  font-weight: bold;
}

.desire-item {
  color: #ffd700;
  margin: 0.2rem 0;
}

/* æ·»åŠ æ»šåŠ¨æ€§èƒ½ä¼˜åŒ– */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

@media (max-width: 768px) {
  .rage-title {
    font-size: 2.5rem;
  }
  
  .rage-tools-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .rage-container {
    padding: 1rem;
  }
}

/* è¡€è‰²æ¨¡å¼æ ·å¼ */
.blood-mode {
  background: linear-gradient(135deg, #8b0000 0%, #dc143c 25%, #ff0000 50%, #b22222 75%, #8b0000 100%) !important;
  animation: bloodPulse 1.5s ease-in-out infinite !important;
}

@keyframes bloodPulse {
  0%, 100% { 
    background: linear-gradient(135deg, #8b0000 0%, #dc143c 25%, #ff0000 50%, #b22222 75%, #8b0000 100%);
  }
  50% { 
    background: linear-gradient(135deg, #ff0000 0%, #8b0000 25%, #dc143c 50%, #ff0000 75%, #b22222 100%);
  }
}

/* ç‹‚èºç—‡æ•ˆæœæ ·å¼ */
.mania-text {
  animation: maniaShake 0.2s infinite;
  text-shadow: 
    2px 0 #ff0000,
    -2px 0 #ff0000,
    0 2px #ff0000,
    0 -2px #ff0000;
}

@keyframes maniaShake {
  0%, 100% {
    transform: translate(0);
  }
  25% {
    transform: translate(-3px, 3px);
  }
  50% {
    transform: translate(-3px, -3px);
  }
  75% {
    transform: translate(3px, 3px);
  }
}

/* ç‹‚èºç—‡ç­‰çº§æ•ˆæœ */
.mania-level-1 .rage-title { animation: maniaShake 0.8s infinite; }
.mania-level-2 .rage-title { animation: maniaShake 0.6s infinite; }
.mania-level-3 .rage-title { animation: maniaShake 0.4s infinite; }
.mania-level-4 .rage-title { animation: maniaShake 0.2s infinite; }
.mania-level-5 .rage-title { animation: maniaShake 0.1s infinite; }

.mania-level-2 .training-card { animation: maniaShake 1s infinite; }
.mania-level-3 .training-card { animation: maniaShake 0.8s infinite; }
.mania-level-4 .training-card { animation: maniaShake 0.6s infinite; }
.mania-level-5 .training-card { animation: maniaShake 0.4s infinite; }

/* è¡€è‰²ç²’å­æ•ˆæœ */
.blood-particle {
  position: fixed;
  font-size: 1.5rem;
  pointer-events: none;
  z-index: 9999;
  animation: bloodFloat 3s linear infinite;
  color: #ff0000;
}

@keyframes bloodFloat {
  0% {
    transform: translateY(0px) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translateY(-100px) rotate(360deg);
    opacity: 0;
  }
}

/* è¡€è‰²é›¨æ•ˆæœ */
.blood-rain {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9998;
  background: 
    radial-gradient(circle at 20% 80%, rgba(139, 0, 0, 0.3) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(220, 20, 60, 0.3) 0%, transparent 50%),
    radial-gradient(circle at 40% 40%, rgba(255, 0, 0, 0.3) 0%, transparent 50%);
  animation: bloodRain 2s ease-in-out infinite;
}

@keyframes bloodRain {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}
</style>
{% endblock %}

{% block content %}


<!-- ç‚¹å‡»è®¡æ•°å™¨ -->
<div class="training-mode-click-counter" id="clickCounter">
  <div>ç‚¹å‡»æ¬¡æ•°: <span id="clickCount">0</span>/4</div>
</div>

<!-- ç‹‚èºç—‡ç­‰çº§æŒ‡ç¤ºå™¨ -->
<div class="mania-level-indicator" id="maniaIndicator">
  <div>ç‹‚èºç—‡ç­‰çº§: <span id="maniaLevel">0</span>/5</div>
  <div class="mania-level-bar">
    <div class="mania-level-fill" id="maniaBar"></div>
  </div>
</div>

<div class="rage-container" id="rageContainer">
  <!-- æµ®åŠ¨ç«ç„°èƒŒæ™¯ -->
  <div class="floating-fire">
    <div class="fire">ğŸ”¥</div>
    <div class="fire">âš¡</div>
    <div class="fire">ğŸ’¥</div>
    <div class="fire">ğŸš€</div>
    <div class="fire">âš”ï¸</div>
    <div class="fire">ğŸ¯</div>
  </div>

  <div class="rage-header">
    <h1 class="rage-title">
      <i class="fas fa-fire"></i> ç‹‚æš´æ¨¡å¼
    </h1>
    <p class="rage-subtitle">ğŸ’ª çªç ´æé™ï¼ŒæŒ‘æˆ˜è‡ªæˆ‘ï¼Œé‡Šæ”¾æ½œèƒ½</p>
  </div>

  <!-- æ¬²æœ›ä»ªè¡¨ç›˜æ˜¾ç¤º -->
  <!-- <div id="desireDisplay" class="desire-display" style="display: none;">
    <div class="desire-bar">[å½“å‰æ¬²æœ›æµ“åº¦] â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 73%</div>
    <div class="desire-item">â–¸ æƒ³è¦ç›èæ‹‰è’‚: â˜…â˜…â˜…â˜†â˜†</div>
    <div class="desire-item">â–¸ æƒ³è¦è¢«ç½‘çº¢æ³¨ç›®: â˜…â˜…â˜†â˜†â˜†</div>
    <div class="desire-item">â–¸ æƒ³è¦ä¸‰å¤©ä¸å†™ä»£ç : â˜…â˜…â˜…â˜…â˜…</div>
  </div> -->

  <div class="rage-tools-grid">
    <div class="training-card" onclick="window.location.href='{% url 'tools:fitness' %}'">
      <div class="training-icon">
        <i class="fas fa-dumbbell"></i>
      </div>
      <h3 class="training-title">æé™å¥èº«</h3>
      <p class="training-description">é«˜å¼ºåº¦è®­ç»ƒè®¡åˆ’ï¼Œçªç ´ä½“èƒ½æé™ï¼ŒæŒ‘æˆ˜èº«ä½“æ½œèƒ½</p>
    </div>

    <div class="training-card" onclick="window.location.href='{% url 'tools:guitar_training' %}'">
      <div class="training-icon">
        <i class="fas fa-guitar"></i>
      </div>
      <h3 class="training-title">ä¸æ‘‡å°±æ»š</h3>
      <p class="training-description">å‰ä»–è®­ç»ƒç³»ç»Ÿï¼Œæ™ºèƒ½è°ƒéŸ³å™¨ã€å’Œå¼¦è®­ç»ƒã€èŠ‚å¥å·¥åŠ</p>
    </div>

    <!-- NutriCoach ProåŠŸèƒ½å·²éšè— -->

    <!-- <div class="training-card" onclick="window.location.href='/tools/triple_awakening/'">
      <div class="training-icon">
        <i class="fas fa-brain"></i>
      </div>
      <h3 class="training-title">ä¸‰é‡è§‰é†’</h3>
      <p class="training-description">ç‰©ç†çº§å­˜åœ¨æ„Ÿ + ä»£ç å¥èº«æˆ¿ + ç—›è‹¦è´§å¸åŒ–ç³»ç»Ÿ</p>
    </div>

    <div class="training-card" onclick="window.location.href='/tools/copilot/'">
      <div class="training-icon">
        <i class="fas fa-robot"></i>
      </div>
      <h3 class="training-title">AIåä½œå£°æ˜</h3>
      <p class="training-description">å±•ç¤ºä½ çš„éª¨æ¶ä»£ç ã€AIè‚Œè‚‰ã€ç¥ç»ç³»ç»Ÿåä½œè¿‡ç¨‹</p>
    </div>

    <div class="training-card" onclick="startCodeWorkout()">
      <div class="training-icon">
        <i class="fas fa-code"></i>
      </div>
      <h3 class="training-title">ä»£ç å¥èº«æˆ¿</h3>
      <p class="training-description">åŸç”ŸJSå¼•ä½“å‘ä¸Š + æ‹’ç»AIå¹³æ¿æ”¯æ’‘ + é‡æ„å‡½æ•°æ·±è¹²</p>
    </div>

    <div class="training-card" onclick="startDailyChallenge()">
      <div class="training-icon">
        <i class="fas fa-trophy"></i>
      </div>
      <h3 class="training-title">æ¯æ—¥æŒ‘æˆ˜</h3>
      <p class="training-description">å®ŒæˆæŒ‘æˆ˜è§£é”"å¼€å‘è€…å¢è‚Œé£Ÿè°±"å½©è›‹</p>
    </div>

    <div class="training-card" onclick="showPainCurrency()">
      <div class="training-icon">
        <i class="fas fa-coins"></i>
      </div>
      <h3 class="training-title">ç—›è‹¦è´§å¸</h3>
      <p class="training-description">åŠ›ç«­å¸ã€æ‹’ç»å¸ã€æ‰‹å†™å¸ã€çªç ´å¸å…‘æ¢ç³»ç»Ÿ</p>
    </div>

    <div class="training-card" onclick="showDesireDashboard()">
      <div class="training-icon">
        <i class="fas fa-heart"></i>
      </div>
      <h3 class="training-title">æ¬²æœ›ä»ªè¡¨ç›˜</h3>
      <p class="training-description">å®æ—¶æ¬²æœ›æµ“åº¦ + AIç”Ÿæˆæ¬²æœ›å…‘ç°å›¾</p>
    </div>

    <div class="training-card" onclick="toggleDesireDisplay()">
      <div class="training-icon">
        <i class="fas fa-eye"></i>
      </div>
      <h3 class="training-title">æ¬²æœ›é¢„è§ˆ</h3>
      <p class="training-description">æŸ¥çœ‹å½“å‰æ¬²æœ›çŠ¶æ€å’Œæ»¡è¶³è¿›åº¦</p>
    </div>

    <div class="training-card" onclick="fulfillDesire()">
      <div class="training-icon">
        <i class="fas fa-magic"></i>
      </div>
      <h3 class="training-title">æ¬²æœ›å…‘ç°</h3>
      <p class="training-description">å®Œæˆä»»åŠ¡ç”ŸæˆAIæ¬²æœ›å…‘ç°å›¾</p>
    </div> -->
  </div>
</div>

<script>
// ä»£ç è®­ç»ƒåŠŸèƒ½
/*
function startCodeWorkout() {
  const workoutType = prompt('é€‰æ‹©è®­ç»ƒç±»å‹:\n1. å¼•ä½“å‘ä¸Š(åŸç”ŸJS)\n2. å¹³æ¿æ”¯æ’‘(æ‹’ç»AI)\n3. æ·±è¹²(é‡æ„å‡½æ•°)\n4. ä¿¯å§æ’‘(æ‰‹å†™ç®—æ³•)\n5. æ³¢æ¯”è·³(è°ƒè¯•ä»£ç )');
  
  if (!workoutType) return;
  
  const workoutData = {
    workout_type: ['pull_up', 'plank', 'squat', 'push_up', 'burpee'][parseInt(workoutType) - 1],
    duration_seconds: Math.floor(Math.random() * 300) + 60,
    difficulty_level: Math.floor(Math.random() * 5) + 1,
    code_snippet: '// ä½ çš„ä»£ç ç‰‡æ®µ',
    ai_rejection_count: Math.floor(Math.random() * 10),
    manual_code_lines: Math.floor(Math.random() * 50) + 10,
    refactored_functions: Math.floor(Math.random() * 5) + 1
  };
  
  fetch('/tools/api/triple_awakening/code-workout/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': getCookie('csrftoken')
    },
    body: JSON.stringify(workoutData)
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      alert('ä»£ç è®­ç»ƒè®°å½•åˆ›å»ºæˆåŠŸï¼');
      // æ£€æŸ¥æ¬²æœ›æ»¡è¶³
      checkDesireFulfillment('coding', `å®Œæˆäº†${workoutData.manual_code_lines}è¡Œä»£ç `);
    } else {
      alert('è®­ç»ƒè®°å½•å¤±è´¥: ' + data.message);
    }
  });
}
*/

// æ¯æ—¥æŒ‘æˆ˜åŠŸèƒ½
/*
function startDailyChallenge() {
  fetch('/tools/api/triple_awakening/workout-dashboard/')
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      alert('æ¯æ—¥æŒ‘æˆ˜å·²å¼€å§‹ï¼\n\nä»»åŠ¡åˆ—è¡¨:\nâ–¢ å†™1è¡ŒåŸç”ŸJS (1ä¸ªå¼•ä½“å‘ä¸Š)\nâ–¢ æ‹’ç»1æ¬¡AIè¡¥å…¨ (10ç§’å¹³æ¿æ”¯æ’‘)\nâ–¢ é‡æ„1ä¸ªå‡½æ•° (20ä¸ªæ·±è¹²)\nâ–¢ æ‰‹å†™ä¸€ä¸ªç®—æ³• (30ä¸ªä¿¯å§æ’‘)\n\nå®Œæˆæ‰€æœ‰ä»»åŠ¡è§£é”"å¼€å‘è€…å¢è‚Œé£Ÿè°±"å½©è›‹ï¼');
    }
  });
}
*/

// ç—›è‹¦è´§å¸å±•ç¤º
/*
function showPainCurrency() {
  fetch('/tools/api/triple_awakening/pain-currency/')
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      let currencyInfo = 'ç—›è‹¦è´§å¸ä½™é¢:\n\n';
      for (const [type, info] of Object.entries(data.data)) {
        currencyInfo += `${info.display_name}: ${info.amount}\n`;
      }
      currencyInfo += '\nå¯ç”¨äºå…‘æ¢:\n- ç½‘ç«™ä¼šå‘˜ç§¯åˆ†\n- ç‰¹æ®ŠåŠŸèƒ½è§£é”\n- æˆå°±å¾½ç« \n- å¼€å‘è€…é£Ÿè°±';
      alert(currencyInfo);
    }
  });
}
*/

// æ˜¾ç¤ºæ¬²æœ›ä»ªè¡¨ç›˜
/*
function showDesireDashboard() {
  window.location.href = '{% url "tools:desire_dashboard" %}';
}
*/

// åˆ‡æ¢æ¬²æœ›æ˜¾ç¤º
/*
function toggleDesireDisplay() {
  const display = document.getElementById('desireDisplay');
  if (display.style.display === 'none') {
    display.style.display = 'block';
    loadDesireData();
  } else {
    display.style.display = 'none';
  }
}
*/

// åŠ è½½æ¬²æœ›æ•°æ®
/*
function loadDesireData() {
  fetch('/tools/api/desire_dashboard/')
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      updateDesireDisplay(data.data);
    }
  });
}
*/

// æ›´æ–°æ¬²æœ›æ˜¾ç¤º
/*
function updateDesireDisplay(data) {
  const display = document.getElementById('desireDisplay');
  const level = data.dashboard.current_desire_level;
  const filledBlocks = Math.floor(level / 10);
  const emptyBlocks = 10 - filledBlocks;
  const bar = 'â–ˆ'.repeat(filledBlocks) + 'â–‘'.repeat(emptyBlocks);
  
  let displayText = `[å½“å‰æ¬²æœ›æµ“åº¦] ${bar} ${level}%\n`;
  
  // æ˜¾ç¤ºå‰3ä¸ªæ¬²æœ›
  data.desires.slice(0, 3).forEach(desire => {
    displayText += `â–¸ ${desire.title}: ${desire.intensity_stars}\n`;
  });
  
  display.textContent = displayText;
}
*/

// æ¬²æœ›å…‘ç°åŠŸèƒ½
/*
function fulfillDesire() {
  const taskType = prompt('é€‰æ‹©ä»»åŠ¡ç±»å‹:\n1. å†™100è¡Œä»£ç \n2. å®Œæˆé«˜å¼ºåº¦è®­ç»ƒ\n3. é‡æ„å‡½æ•°\n4. å®Œæˆé¡¹ç›®');
  
  if (!taskType) return;
  
  const taskTypes = ['coding', 'fitness', 'coding', 'coding'];
  const taskDetails = [
    'å®Œæˆäº†100è¡Œä»£ç ',
    'å®Œæˆäº†é«˜å¼ºåº¦è®­ç»ƒ',
    'é‡æ„äº†å‡½æ•°',
    'å®Œæˆäº†å®Œæ•´é¡¹ç›®'
  ];
  
  const selectedType = taskTypes[parseInt(taskType) - 1];
  const selectedDetails = taskDetails[parseInt(taskType) - 1];
  
  checkDesireFulfillment(selectedType, selectedDetails);
}
*/

// æ£€æŸ¥æ¬²æœ›æ»¡è¶³
/*
function checkDesireFulfillment(taskType, taskDetails) {
  fetch('/tools/api/desire_dashboard/check-fulfillment/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': getCookie('csrftoken')
    },
    body: JSON.stringify({
      task_type: taskType,
      task_details: taskDetails
    })
  })
  .then(response => response.json())
  .then(data => {
    if (data.success && data.fulfilled_desires && data.fulfilled_desires.length > 0) {
      alert(`ğŸ‰ ${data.message}\n\næ»¡è¶³çš„æ¬²æœ›:\n${data.fulfilled_desires.map(d => `- ${d.desire_title}`).join('\n')}\n\næ­£åœ¨ç”ŸæˆAIå…‘ç°å›¾ç‰‡...`);
      
      // ä¸ºæ¯ä¸ªæ»¡è¶³çš„æ¬²æœ›ç”ŸæˆAIå›¾ç‰‡
      data.fulfilled_desires.forEach(desire => {
        generateDesireImage(desire.fulfillment_id, desire.desire_title);
      });
    } else {
      alert(data.message || 'ç»§ç»­åŠªåŠ›ï¼Œè¿˜æ²¡æœ‰æ»¡è¶³çš„æ¬²æœ›ï¼');
    }
  });
}
*/

// ç”Ÿæˆæ¬²æœ›å…‘ç°å›¾ç‰‡
/*
function generateDesireImage(fulfillmentId, desireTitle) {
  fetch('/tools/api/desire_dashboard/generate-image/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': getCookie('csrftoken')
    },
    body: JSON.stringify({
      fulfillment_id: fulfillmentId
    })
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      alert(`ğŸ¨ AIå›¾ç‰‡ç”ŸæˆæˆåŠŸï¼\n\næ¬²æœ›: ${desireTitle}\nå›¾ç‰‡: ${data.image_url}\n\nè¿™å°±æ˜¯ä½ çš„æ¬²æœ›å…‘ç°å›¾ï¼`);
    } else {
      alert('AIå›¾ç‰‡ç”Ÿæˆå¤±è´¥: ' + data.message);
    }
  });
}
*/

// è·å–CSRF Token
function getCookie(name) {
  let cookieValue = null;
  if (document.cookie && document.cookie !== '') {
    const cookies = document.cookie.split(';');
    for (let i = 0; i < cookies.length; i++) {
      const cookie = cookies[i].trim();
      if (cookie.substring(0, name.length + 1) === (name + '=')) {
        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
        break;
      }
    }
  }
  return cookieValue;
}

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–æ¬²æœ›æ˜¾ç¤º
/*
document.addEventListener('DOMContentLoaded', function() {
  // å»¶è¿Ÿæ˜¾ç¤ºæ¬²æœ›ä»ªè¡¨ç›˜ï¼Œå¢åŠ ç¥ç§˜æ„Ÿ
  setTimeout(() => {
    const display = document.getElementById('desireDisplay');
    display.style.display = 'block';
    loadDesireData();
  }, 2000);
});
*/

// ç‹‚æš´æ¨¡å¼ç‚¹å‡»è®¡æ•°å™¨
let trainingModeClickCount = 0;
let bloodMode = false;
let maniaLevel = 0;
let maniaResetTimer = null;

// é¡µé¢ç‚¹å‡»äº‹ä»¶ç›‘å¬
document.addEventListener('click', function(e) {
  // å¢åŠ ç‚¹å‡»è®¡æ•°
  trainingModeClickCount++;

  // æ˜¾ç¤ºç‚¹å‡»è®¡æ•°å™¨
  const clickCounter = document.getElementById('clickCounter');
  const clickCount = document.getElementById('clickCount');
  clickCounter.classList.add('show');
  clickCount.textContent = trainingModeClickCount;
  
  // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°4æ¬¡ç‚¹å‡»
  if (trainingModeClickCount >= 4 && !bloodMode) {
    activateBloodMode();
  }
  
  // å¦‚æœå·²ç»åœ¨è¡€è‰²æ¨¡å¼ä¸‹ï¼Œå¢åŠ ç‹‚èºç—‡ç­‰çº§
  if (bloodMode) {
    increaseManiaLevel();
  }
});

// æ¿€æ´»è¡€è‰²æ¨¡å¼
function activateBloodMode() {

  bloodMode = true;
  
  // æ·»åŠ è¡€è‰²æ ·å¼
  const container = document.getElementById('rageContainer');
  if (container) {
    container.classList.add('blood-mode');
  }
  
  // æ˜¾ç¤ºç‹‚èºç—‡ç­‰çº§æŒ‡ç¤ºå™¨
  const maniaIndicator = document.getElementById('maniaIndicator');
  maniaIndicator.classList.add('show');
  
  // åˆ›å»ºè¡€è‰²æ•ˆæœ
  createBloodEffect();
  
  // æ˜¾ç¤ºè¡€è‰²æç¤º
  showBloodMessage();
}

// å¢åŠ ç‹‚èºç—‡ç­‰çº§
function increaseManiaLevel() {
  maniaLevel = Math.min(maniaLevel + 1, 5);

  // æ›´æ–°ç‹‚èºç—‡ç­‰çº§æ˜¾ç¤º
  const maniaLevelSpan = document.getElementById('maniaLevel');
  const maniaBar = document.getElementById('maniaBar');
  
  if (maniaLevelSpan) {
    maniaLevelSpan.textContent = maniaLevel;
  }
  
  if (maniaBar) {
    maniaBar.style.width = (maniaLevel / 5 * 100) + '%';
  }
  
  // æ·»åŠ ç‹‚èºç—‡ç­‰çº§æ ·å¼
  const container = document.getElementById('rageContainer');
  if (container) {
    // ç§»é™¤ä¹‹å‰çš„ç‹‚èºç—‡ç­‰çº§æ ·å¼
    container.classList.remove('mania-level-1', 'mania-level-2', 'mania-level-3', 'mania-level-4', 'mania-level-5');
    // æ·»åŠ å½“å‰ç‹‚èºç—‡ç­‰çº§æ ·å¼
    container.classList.add('mania-level-' + maniaLevel);
  }
  
  // é‡ç½®ç‹‚èºç—‡ç­‰çº§è®¡æ—¶å™¨
  if (maniaResetTimer) {
    clearTimeout(maniaResetTimer);
  }
  
  // 5ç§’åè‡ªåŠ¨é‡ç½®ç‹‚èºç—‡ç­‰çº§
  maniaResetTimer = setTimeout(() => {
    resetManiaLevel();
  }, 5000);
}

// é‡ç½®ç‹‚èºç—‡ç­‰çº§
function resetManiaLevel() {

  maniaLevel = 0;
  
  // æ›´æ–°æ˜¾ç¤º
  const maniaLevelSpan = document.getElementById('maniaLevel');
  const maniaBar = document.getElementById('maniaBar');
  
  if (maniaLevelSpan) {
    maniaLevelSpan.textContent = maniaLevel;
  }
  
  if (maniaBar) {
    maniaBar.style.width = '0%';
  }
  
  // ç§»é™¤ç‹‚èºç—‡ç­‰çº§æ ·å¼
  const container = document.getElementById('rageContainer');
  if (container) {
    container.classList.remove('mania-level-1', 'mania-level-2', 'mania-level-3', 'mania-level-4', 'mania-level-5');
  }
}

// åˆ›å»ºè¡€è‰²æ•ˆæœ
function createBloodEffect() {
  // åˆ›å»ºè¡€è‰²é›¨æ•ˆæœ
  const bloodRain = document.createElement('div');
  bloodRain.className = 'blood-rain';
  document.body.appendChild(bloodRain);
  
  // åˆ›å»ºè¡€è‰²ç²’å­
  for (let i = 0; i < 30; i++) {
    createBloodParticle();
  }
  
  // 5ç§’åç§»é™¤è¡€è‰²é›¨
  setTimeout(() => {
    if (bloodRain.parentNode) {
      bloodRain.parentNode.removeChild(bloodRain);
    }
  }, 5000);
}

// åˆ›å»ºè¡€è‰²ç²’å­
function createBloodParticle() {
  const particle = document.createElement('div');
  particle.className = 'blood-particle';
  particle.innerHTML = ['ğŸ©¸', 'ğŸ’€', 'âš”ï¸', 'ğŸ”¥', 'ğŸ’¥'][Math.floor(Math.random() * 5)];
  particle.style.left = Math.random() * 100 + '%';
  particle.style.top = Math.random() * 100 + '%';
  particle.style.animationDelay = Math.random() * 2 + 's';
  
  document.body.appendChild(particle);
  
  // åŠ¨ç”»ç»“æŸåç§»é™¤ç²’å­
  setTimeout(() => {
    if (particle.parentNode) {
      particle.parentNode.removeChild(particle);
    }
  }, 3000);
}

// æ˜¾ç¤ºè¡€è‰²æç¤º
function showBloodMessage() {
  const message = document.createElement('div');
  message.style.cssText = `
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10000;
    background: rgba(139, 0, 0, 0.9);
    color: #ff0000;
    padding: 2rem;
    border-radius: 10px;
    text-align: center;
    border: 2px solid #ff0000;
    font-family: 'Courier New', monospace;
    animation: messagePop 0.5s ease-out;
  `;
  message.innerHTML = `
    <h2 style="color: #ff0000; margin-bottom: 1rem;">ğŸ©¸ è¡€è‰²æ¨¡å¼æ¿€æ´»</h2>
    <p style="color: #ffffff; margin: 0;">é¡µé¢ç‚¹å‡»ä¼šå¢åŠ ç‹‚èºç—‡ç­‰çº§</p>
    <p style="color: #ffffff; margin: 0;">ç‹‚èºç—‡ç­‰çº§ä¼šåœ¨5ç§’åè‡ªåŠ¨é‡ç½®</p>
  `;
  document.body.appendChild(message);
  
  setTimeout(() => {
    if (message.parentNode) {
      message.parentNode.removeChild(message);
    }
  }, 3000);
}

// åˆå§‹åŒ–è®¡æ•°å™¨ï¼ˆåˆå§‹çŠ¶æ€ï¼‰
document.addEventListener('DOMContentLoaded', function() {
  const clickCounter = document.getElementById('clickCounter');
  const maniaIndicator = document.getElementById('maniaIndicator');
  
  if (clickCounter) {
    clickCounter.classList.remove('show');
  }
  
  if (maniaIndicator) {
    maniaIndicator.classList.remove('show');
  }
});
</script>
{% endblock %} 