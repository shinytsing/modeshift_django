{% extends 'base.html' %}
{% load static %}

{% block title %}å‰ä»–ä¹ç†å­¦ä¹ æŒ‡å—{% endblock %}

{% block extra_css %}
<style>
    .theory-guide {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
    }
    
    .guide-header {
        text-align: center;
        color: white;
        margin-bottom: 30px;
    }
    
    .guide-header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .guide-header p {
        font-size: 1.2rem;
        opacity: 0.9;
    }
    
    .user-level-badge {
        display: inline-block;
        padding: 8px 16px;
        border-radius: 20px;
        color: white;
        font-weight: bold;
        margin-bottom: 20px;
    }
    
    .level-beginner { background-color: #4CAF50; }
    .level-intermediate { background-color: #FF9800; }
    .level-advanced { background-color: #F44336; }
    
    .theory-content {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 30px;
    }
    
    .difficulty-tabs {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }
    
    .difficulty-tab {
        padding: 12px 24px;
        border: none;
        border-radius: 25px;
        background: #f8f9fa;
        color: #666;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 500;
    }
    
    .difficulty-tab.active {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    
    .difficulty-tab:hover {
        background: #5a6fd8;
        color: white;
        transform: translateY(-2px);
    }
    
    .theory-section {
        margin-bottom: 40px;
    }
    
    .theory-section h2 {
        color: #333;
        margin-bottom: 20px;
        font-size: 1.8rem;
        border-bottom: 3px solid #667eea;
        padding-bottom: 10px;
    }
    
    .theory-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .theory-card {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        border-left: 4px solid #667eea;
    }
    
    .theory-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    .theory-card h3 {
        color: #333;
        margin-bottom: 15px;
        font-size: 1.3rem;
    }
    
    .theory-card p {
        color: #666;
        line-height: 1.6;
        margin-bottom: 15px;
    }
    
    .theory-examples {
        background: #e3f2fd;
        border-radius: 10px;
        padding: 15px;
        margin-top: 15px;
    }
    
    .theory-examples h4 {
        color: #1976D2;
        margin-bottom: 10px;
        font-size: 1.1rem;
    }
    
    .example-list {
        list-style: none;
        padding: 0;
    }
    
    .example-list li {
        padding: 5px 0;
        color: #333;
        position: relative;
        padding-left: 20px;
    }
    
    .example-list li:before {
        content: "ğŸµ";
        position: absolute;
        left: 0;
        top: 5px;
    }
    
    .interactive-section {
        background: #fff3e0;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 30px;
        border-left: 4px solid #FF9800;
    }
    
    .interactive-section h3 {
        color: #E65100;
        margin-bottom: 15px;
    }
    
    .interactive-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
    }
    
    .interactive-item {
        background: white;
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }
    
    .interactive-item:hover {
        border-color: #FF9800;
        transform: scale(1.05);
    }
    
    .interactive-icon {
        font-size: 2rem;
        margin-bottom: 10px;
        display: block;
    }
    
    .progress-section {
        background: #e8f5e8;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 30px;
        border-left: 4px solid #4CAF50;
    }
    
    .progress-section h3 {
        color: #2E7D32;
        margin-bottom: 15px;
    }
    
    .progress-item {
        background: white;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
    }
    
    .progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .progress-title {
        font-weight: bold;
        color: #333;
    }
    
    .progress-percentage {
        color: #4CAF50;
        font-weight: bold;
    }
    
    .progress-bar {
        width: 100%;
        height: 8px;
        background: #e9ecef;
        border-radius: 4px;
        overflow: hidden;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(45deg, #4CAF50, #45a049);
        transition: width 0.3s ease;
    }
    
    .navigation-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
    }
    
    .nav-btn {
        background: rgba(255, 255, 255, 0.9);
        color: #333;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .nav-btn:hover {
        background: white;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        text-decoration: none;
        color: #333;
    }
    
    .empty-state {
        text-align: center;
        padding: 40px;
        color: #666;
    }
    
    .empty-state-icon {
        font-size: 4rem;
        margin-bottom: 20px;
        opacity: 0.5;
    }
    
    @media (max-width: 768px) {
        .theory-grid {
            grid-template-columns: 1fr;
        }
        
        .interactive-content {
            grid-template-columns: 1fr;
        }
        
        .difficulty-tabs {
            flex-direction: column;
            align-items: center;
        }
        
        .guide-header h1 {
            font-size: 2rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="theory-guide">
    <div class="guide-header">
        <h1>ğŸ“š å‰ä»–ä¹ç†å­¦ä¹ æŒ‡å—</h1>
        <p>ä»åŸºç¡€åˆ°é«˜çº§çš„å®Œæ•´ä¹ç†çŸ¥è¯†ä½“ç³»</p>
        <div class="user-level-badge level-{{ user_level }}">
            {{ user_level|title }} ç­‰çº§
        </div>
    </div>

    <div class="theory-content">
        <!-- éš¾åº¦é€‰æ‹©æ ‡ç­¾ -->
        <div class="difficulty-tabs">
            <button class="difficulty-tab active" onclick="switchDifficulty('beginner')">åˆå­¦è€…</button>
            <button class="difficulty-tab" onclick="switchDifficulty('intermediate')">è¿›é˜¶è€…</button>
            <button class="difficulty-tab" onclick="switchDifficulty('advanced')">é«˜çº§è€…</button>
        </div>

        <!-- åˆå­¦è€…å†…å®¹ -->
        <div id="beginner-content" class="theory-section">
            <h2>ğŸµ åˆå­¦è€…ä¹ç†åŸºç¡€</h2>
            
            <div class="theory-grid">
                <div class="theory-card">
                    <h3>éŸ³ç¬¦åŸºç¡€</h3>
                    <p>å­¦ä¹ åŸºæœ¬éŸ³ç¬¦çš„åç§°ã€æ—¶å€¼å’Œåœ¨äº”çº¿è°±ä¸Šçš„ä½ç½®ã€‚æŒæ¡å…¨éŸ³ç¬¦ã€äºŒåˆ†éŸ³ç¬¦ã€å››åˆ†éŸ³ç¬¦ã€å…«åˆ†éŸ³ç¬¦ç­‰åŸºæœ¬æ—¶å€¼ã€‚</p>
                    <div class="theory-examples">
                        <h4>åŸºæœ¬éŸ³ç¬¦ï¼š</h4>
                        <ul class="example-list">
                            <li>å…¨éŸ³ç¬¦ (ğ…) - 4æ‹</li>
                            <li>äºŒåˆ†éŸ³ç¬¦ (ğ…—ğ…¥) - 2æ‹</li>
                            <li>å››åˆ†éŸ³ç¬¦ (â™©) - 1æ‹</li>
                            <li>å…«åˆ†éŸ³ç¬¦ (â™ª) - 1/2æ‹</li>
                        </ul>
                    </div>
                </div>
                
                <div class="theory-card">
                    <h3>èŠ‚æ‹ä¸æ‹å·</h3>
                    <p>ç†è§£æ‹å·çš„å«ä¹‰ï¼ŒæŒæ¡å¸¸è§çš„2/4ã€3/4ã€4/4æ‹å·ï¼Œå­¦ä¼šæ•°æ‹å­å’Œä¿æŒç¨³å®šçš„èŠ‚å¥ã€‚</p>
                    <div class="theory-examples">
                        <h4>å¸¸è§æ‹å·ï¼š</h4>
                        <ul class="example-list">
                            <li>2/4æ‹ - æ¯å°èŠ‚2æ‹ï¼Œä»¥å››åˆ†éŸ³ç¬¦ä¸ºä¸€æ‹</li>
                            <li>3/4æ‹ - æ¯å°èŠ‚3æ‹ï¼Œä»¥å››åˆ†éŸ³ç¬¦ä¸ºä¸€æ‹</li>
                            <li>4/4æ‹ - æ¯å°èŠ‚4æ‹ï¼Œä»¥å››åˆ†éŸ³ç¬¦ä¸ºä¸€æ‹</li>
                        </ul>
                    </div>
                </div>
                
                <div class="theory-card">
                    <h3>å’Œå¼¦æ„æˆ</h3>
                    <p>å­¦ä¹ å’Œå¼¦çš„åŸºæœ¬æ„æˆåŸç†ï¼Œäº†è§£ä¸‰å’Œå¼¦çš„æ„æˆæ–¹å¼ï¼ŒæŒæ¡Cã€Gã€Amã€Fç­‰åŸºç¡€å’Œå¼¦ã€‚</p>
                    <div class="theory-examples">
                        <h4>åŸºç¡€å’Œå¼¦ï¼š</h4>
                        <ul class="example-list">
                            <li>Cå’Œå¼¦ - C-E-G (1-3-5)</li>
                            <li>Gå’Œå¼¦ - G-B-D (1-3-5)</li>
                            <li>Amå’Œå¼¦ - A-C-E (1-â™­3-5)</li>
                            <li>Få’Œå¼¦ - F-A-C (1-3-5)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¿›é˜¶è€…å†…å®¹ -->
        <div id="intermediate-content" class="theory-section" style="display: none;">
            <h2>ğŸ¼ è¿›é˜¶è€…ä¹ç†çŸ¥è¯†</h2>
            
            <div class="theory-grid">
                <div class="theory-card">
                    <h3>è°ƒå¼ç†è®º</h3>
                    <p>æ·±å…¥å­¦ä¹ å¤§è°ƒå’Œå°è°ƒéŸ³é˜¶ï¼Œç†è§£è°ƒå¼çš„æ¦‚å¿µï¼ŒæŒæ¡äº”å£°éŸ³é˜¶å’Œå¸ƒé²æ–¯éŸ³é˜¶çš„ç‰¹ç‚¹ã€‚</p>
                    <div class="theory-examples">
                        <h4>å¸¸è§éŸ³é˜¶ï¼š</h4>
                        <ul class="example-list">
                            <li>Cå¤§è°ƒéŸ³é˜¶ - C D E F G A B C</li>
                            <li>Aå°è°ƒéŸ³é˜¶ - A B C D E F G A</li>
                            <li>Cäº”å£°éŸ³é˜¶ - C D E G A</li>
                            <li>Cå¸ƒé²æ–¯éŸ³é˜¶ - C Eâ™­ F Fâ™¯ G Bâ™­</li>
                        </ul>
                    </div>
                </div>
                
                <div class="theory-card">
                    <h3>å’Œå£°è¿›è¡Œ</h3>
                    <p>å­¦ä¹ å’Œå£°è¿›è¡Œçš„åŸºæœ¬åŸç†ï¼ŒæŒæ¡å¸¸è§çš„å’Œå¼¦è¿›è¡Œæ¨¡å¼ï¼Œç†è§£åŠŸèƒ½å’Œå£°çš„æ¦‚å¿µã€‚</p>
                    <div class="theory-examples">
                        <h4>å¸¸è§è¿›è¡Œï¼š</h4>
                        <ul class="example-list">
                            <li>I-IV-Vè¿›è¡Œ - C-F-G</li>
                            <li>I-V-vi-IVè¿›è¡Œ - C-G-Am-F</li>
                            <li>ii-V-Iè¿›è¡Œ - Dm-G-C</li>
                            <li>vi-IV-I-Vè¿›è¡Œ - Am-F-C-G</li>
                        </ul>
                    </div>
                </div>
                
                <div class="theory-card">
                    <h3>èŠ‚å¥æ¨¡å¼</h3>
                    <p>å­¦ä¹ å¤æ‚çš„èŠ‚å¥æ¨¡å¼ï¼ŒæŒæ¡åˆ‡åˆ†éŸ³ã€é™„ç‚¹éŸ³ç¬¦ã€è¿éŸ³ç­‰é«˜çº§èŠ‚å¥æŠ€å·§ã€‚</p>
                    <div class="theory-examples">
                        <h4>èŠ‚å¥æŠ€å·§ï¼š</h4>
                        <ul class="example-list">
                            <li>åˆ‡åˆ†éŸ³ - å¼ºè°ƒå¼±æ‹</li>
                            <li>é™„ç‚¹éŸ³ç¬¦ - å»¶é•¿æ—¶å€¼</li>
                            <li>ä¸‰è¿éŸ³ - ä¸‰ç­‰åˆ†æ—¶å€¼</li>
                            <li>æ‘‡æ‘†èŠ‚å¥ - å…«åˆ†éŸ³ç¬¦ä¸ç­‰åˆ†</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- é«˜çº§è€…å†…å®¹ -->
        <div id="advanced-content" class="theory-section" style="display: none;">
            <h2>ğŸ¹ é«˜çº§è€…ä¹ç†ç†è®º</h2>
            
            <div class="theory-grid">
                <div class="theory-card">
                    <h3>çˆµå£«ç†è®º</h3>
                    <p>æ·±å…¥å­¦ä¹ çˆµå£«éŸ³ä¹ç†è®ºï¼ŒæŒæ¡ä¸ƒå’Œå¼¦ã€ä¹å’Œå¼¦ã€åä¸€å’Œå¼¦ç­‰å¤æ‚å’Œå¼¦çš„æ„æˆå’Œåº”ç”¨ã€‚</p>
                    <div class="theory-examples">
                        <h4>çˆµå£«å’Œå¼¦ï¼š</h4>
                        <ul class="example-list">
                            <li>Cmaj7 - C-E-G-B</li>
                            <li>Dm7 - D-F-A-C</li>
                            <li>G7 - G-B-D-F</li>
                            <li>Am7 - A-C-E-G</li>
                        </ul>
                    </div>
                </div>
                
                <div class="theory-card">
                    <h3>ç°ä»£å’Œå£°</h3>
                    <p>å­¦ä¹ ç°ä»£å’Œå£°ç†è®ºï¼ŒæŒæ¡è°ƒå¼äº’æ¢ã€æ›¿ä»£å’Œå¼¦ã€å˜åŒ–å’Œå¼¦ç­‰é«˜çº§å’Œå£°æŠ€å·§ã€‚</p>
                    <div class="theory-examples">
                        <h4>ç°ä»£æŠ€å·§ï¼š</h4>
                        <ul class="example-list">
                            <li>è°ƒå¼äº’æ¢ - å€Ÿç”¨å¹³è¡Œè°ƒå’Œå¼¦</li>
                            <li>æ›¿ä»£å’Œå¼¦ - åŠŸèƒ½ç›¸åŒçš„å’Œå¼¦</li>
                            <li>å˜åŒ–å’Œå¼¦ - æ”¹å˜å’Œå¼¦éŸ³</li>
                            <li>æ‰©å±•å’Œå¼¦ - æ·»åŠ ä¹éŸ³ã€åä¸€éŸ³</li>
                        </ul>
                    </div>
                </div>
                
                <div class="theory-card">
                    <h3>å¤è°ƒéŸ³ä¹</h3>
                    <p>å­¦ä¹ å¤è°ƒéŸ³ä¹ç†è®ºï¼ŒæŒæ¡å¯¹ä½æ³•ã€å£°éƒ¨è¿›è¡Œã€å’Œå£°å¤–éŸ³ç­‰é«˜çº§ä½œæ›²æŠ€å·§ã€‚</p>
                    <div class="theory-examples">
                        <h4>å¤è°ƒæŠ€å·§ï¼š</h4>
                        <ul class="example-list">
                            <li>å¯¹ä½æ³• - å¤šå£°éƒ¨ç‹¬ç«‹è¿›è¡Œ</li>
                            <li>å£°éƒ¨è¿›è¡Œ - å„å£°éƒ¨çš„è¿åŠ¨</li>
                            <li>å’Œå£°å¤–éŸ³ - éå’Œå¼¦éŸ³</li>
                            <li>æ¨¡è¿› - éŸ³å‹é‡å¤</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- äº’åŠ¨å­¦ä¹ åŒºåŸŸ -->
        <div class="interactive-section">
            <h3>ğŸ¯ äº’åŠ¨å­¦ä¹ </h3>
            <div class="interactive-content">
                <div class="interactive-item" onclick="startTheoryQuiz()">
                    <span class="interactive-icon">ğŸ“</span>
                    <h4>ä¹ç†æµ‹éªŒ</h4>
                    <p>æµ‹è¯•ä½ çš„ä¹ç†çŸ¥è¯†æŒæ¡ç¨‹åº¦</p>
                </div>
                <div class="interactive-item" onclick="showChordBuilder()">
                    <span class="interactive-icon">ğŸ¼</span>
                    <h4>å’Œå¼¦æ„å»ºå™¨</h4>
                    <p>å¯è§†åŒ–å­¦ä¹ å’Œå¼¦æ„æˆ</p>
                </div>
                <div class="interactive-item" onclick="showScaleVisualizer()">
                    <span class="interactive-icon">ğŸµ</span>
                    <h4>éŸ³é˜¶å¯è§†åŒ–</h4>
                    <p>åœ¨æŒ‡æ¿ä¸ŠæŸ¥çœ‹éŸ³é˜¶ä½ç½®</p>
                </div>
                <div class="interactive-item" onclick="showProgressTracker()">
                    <span class="interactive-icon">ğŸ“Š</span>
                    <h4>å­¦ä¹ è¿›åº¦</h4>
                    <p>è·Ÿè¸ªä½ çš„ä¹ç†å­¦ä¹ è¿›åº¦</p>
                </div>
            </div>
        </div>

        <!-- å­¦ä¹ è¿›åº¦ -->
        <div class="progress-section">
            <h3>ğŸ“ˆ å­¦ä¹ è¿›åº¦</h3>
            <div class="progress-item">
                <div class="progress-header">
                    <span class="progress-title">éŸ³ç¬¦åŸºç¡€</span>
                    <span class="progress-percentage">85%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 85%"></div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-header">
                    <span class="progress-title">å’Œå¼¦ç†è®º</span>
                    <span class="progress-percentage">70%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 70%"></div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-header">
                    <span class="progress-title">è°ƒå¼ç†è®º</span>
                    <span class="progress-percentage">60%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 60%"></div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-header">
                    <span class="progress-title">å’Œå£°è¿›è¡Œ</span>
                    <span class="progress-percentage">45%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 45%"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¯¼èˆªæŒ‰é’® -->
    <div class="navigation-buttons">
        <a href="{% url 'tools:guitar_training_dashboard' %}" class="nav-btn">ğŸ  è¿”å›ä¸»é¡µ</a>
<a href="{% url 'tools:guitar_progress_tracking' %}" class="nav-btn">ğŸ“Š è¿›åº¦è·Ÿè¸ª</a>
<a href="{% url 'tools:guitar_song_library' %}" class="nav-btn">ğŸµ æ­Œæ›²åº“</a>
        <a href="#" class="nav-btn" onclick="downloadTheoryGuide()">ğŸ“¥ ä¸‹è½½æŒ‡å—</a>
    </div>
</div>

<!-- ä¹ç†æµ‹éªŒæ¨¡æ€æ¡† -->
<div class="modal fade" id="theoryQuizModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ğŸµ ä¹ç†çŸ¥è¯†æµ‹éªŒ</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="quizContent">
                    <!-- æµ‹éªŒå†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                <button type="button" class="btn btn-primary" onclick="submitQuiz()">æäº¤ç­”æ¡ˆ</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
let currentDifficulty = 'beginner';

function switchDifficulty(difficulty) {
    // æ›´æ–°æ ‡ç­¾çŠ¶æ€
    document.querySelectorAll('.difficulty-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // éšè—æ‰€æœ‰å†…å®¹
    document.querySelectorAll('.theory-section').forEach(section => {
        section.style.display = 'none';
    });
    
    // æ˜¾ç¤ºå¯¹åº”å†…å®¹
    document.getElementById(difficulty + '-content').style.display = 'block';
    
    currentDifficulty = difficulty;
}

function startTheoryQuiz() {
    const modal = new bootstrap.Modal(document.getElementById('theoryQuizModal'));
    generateQuiz();
    modal.show();
}

function generateQuiz() {
    const quizContent = document.getElementById('quizContent');
    const questions = getQuizQuestions(currentDifficulty);
    
    let html = '<div class="quiz-container">';
    questions.forEach((question, index) => {
        html += `
            <div class="quiz-question mb-4">
                <h6>é—®é¢˜ ${index + 1}: ${question.question}</h6>
                <div class="quiz-options">
                    ${question.options.map((option, optIndex) => `
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="q${index}" id="q${index}opt${optIndex}" value="${optIndex}">
                            <label class="form-check-label" for="q${index}opt${optIndex}">
                                ${option}
                            </label>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    });
    html += '</div>';
    
    quizContent.innerHTML = html;
}

function getQuizQuestions(difficulty) {
    const questions = {
        beginner: [
            {
                question: "å››åˆ†éŸ³ç¬¦çš„æ—¶å€¼æ˜¯å¤šå°‘ï¼Ÿ",
                options: ["1æ‹", "2æ‹", "4æ‹", "1/2æ‹"],
                correct: 0
            },
            {
                question: "Cå¤§è°ƒéŸ³é˜¶çš„ç¬¬ä¸€ä¸ªéŸ³æ˜¯ä»€ä¹ˆï¼Ÿ",
                options: ["D", "E", "C", "F"],
                correct: 2
            },
            {
                question: "4/4æ‹å·è¡¨ç¤ºä»€ä¹ˆï¼Ÿ",
                options: ["æ¯å°èŠ‚4æ‹ï¼Œä»¥å››åˆ†éŸ³ç¬¦ä¸ºä¸€æ‹", "æ¯å°èŠ‚2æ‹ï¼Œä»¥å››åˆ†éŸ³ç¬¦ä¸ºä¸€æ‹", "æ¯å°èŠ‚3æ‹ï¼Œä»¥å››åˆ†éŸ³ç¬¦ä¸ºä¸€æ‹", "æ¯å°èŠ‚8æ‹ï¼Œä»¥å››åˆ†éŸ³ç¬¦ä¸ºä¸€æ‹"],
                correct: 0
            }
        ],
        intermediate: [
            {
                question: "Aå°è°ƒéŸ³é˜¶çš„ç¬¬ä¸‰ä¸ªéŸ³æ˜¯ä»€ä¹ˆï¼Ÿ",
                options: ["A", "B", "C", "D"],
                correct: 2
            },
            {
                question: "I-IV-Vè¿›è¡Œåœ¨Cå¤§è°ƒä¸­æ˜¯ä»€ä¹ˆï¼Ÿ",
                options: ["C-F-G", "C-G-Am", "Am-F-C", "Dm-G-C"],
                correct: 0
            },
            {
                question: "äº”å£°éŸ³é˜¶æœ‰å‡ ä¸ªéŸ³ï¼Ÿ",
                options: ["5ä¸ª", "6ä¸ª", "7ä¸ª", "8ä¸ª"],
                correct: 0
            }
        ],
        advanced: [
            {
                question: "Cmaj7å’Œå¼¦çš„æ„æˆæ˜¯ä»€ä¹ˆï¼Ÿ",
                options: ["C-E-G", "C-E-G-B", "C-Eb-G-Bb", "C-E-G-B-D"],
                correct: 1
            },
            {
                question: "è°ƒå¼äº’æ¢æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ",
                options: ["æ”¹å˜è°ƒå·", "å€Ÿç”¨å¹³è¡Œè°ƒçš„å’Œå¼¦", "æ”¹å˜æ‹å·", "æ”¹å˜é€Ÿåº¦"],
                correct: 1
            },
            {
                question: "å¯¹ä½æ³•ä¸»è¦ç”¨äºä»€ä¹ˆï¼Ÿ",
                options: ["å•å£°éƒ¨éŸ³ä¹", "å¤šå£°éƒ¨éŸ³ä¹", "æ‰“å‡»ä¹", "ç‹¬å¥"],
                correct: 1
            }
        ]
    };
    
    return questions[difficulty] || questions.beginner;
}

function submitQuiz() {
    const questions = getQuizQuestions(currentDifficulty);
    let score = 0;
    
    questions.forEach((question, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected && parseInt(selected.value) === question.correct) {
            score++;
        }
    });
    
    const percentage = Math.round((score / questions.length) * 100);
    
    const quizContent = document.getElementById('quizContent');
    quizContent.innerHTML = `
        <div class="text-center">
            <h4>ğŸ‰ æµ‹éªŒå®Œæˆï¼</h4>
            <p>ä½ çš„å¾—åˆ†: ${score}/${questions.length} (${percentage}%)</p>
            <div class="progress mb-3">
                <div class="progress-bar" style="width: ${percentage}%"></div>
            </div>
            <p>${getQuizFeedback(percentage)}</p>
        </div>
    `;
}

function getQuizFeedback(percentage) {
    if (percentage >= 90) return "ä¼˜ç§€ï¼ä½ å¯¹ä¹ç†çŸ¥è¯†æŒæ¡å¾—å¾ˆå¥½ï¼";
    if (percentage >= 70) return "è‰¯å¥½ï¼ç»§ç»­åŠªåŠ›ï¼Œä½ ä¼šæ›´æ£’çš„ï¼";
    if (percentage >= 50) return "åŠæ ¼ï¼å»ºè®®å¤šå¤ä¹ ä¸€ä¸‹ç›¸å…³çŸ¥è¯†ã€‚";
    return "éœ€è¦åŠ å¼ºå­¦ä¹ ï¼Œå»ºè®®é‡æ–°å­¦ä¹ ç›¸å…³ç« èŠ‚ã€‚";
}

function showChordBuilder() {
    alert('å’Œå¼¦æ„å»ºå™¨åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...');
}

function showScaleVisualizer() {
    alert('éŸ³é˜¶å¯è§†åŒ–åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...');
}

function showProgressTracker() {
    window.location.href = "{% url 'tools:guitar_progress_tracking' %}";
}

function downloadTheoryGuide() {
    // åˆ›å»ºä¹ç†æŒ‡å—PDFä¸‹è½½
    const guideData = {
        difficulty: currentDifficulty,
        content: document.querySelector('.theory-content').innerText,
        timestamp: new Date().toISOString()
    };
    
    const blob = new Blob([JSON.stringify(guideData, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `guitar_theory_guide_${currentDifficulty}_${new Date().toISOString().split('T')[0]}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    // æ ¹æ®ç”¨æˆ·ç­‰çº§è®¾ç½®é»˜è®¤éš¾åº¦
    const userLevel = '{{ user_level }}';
    if (userLevel !== 'beginner') {
        switchDifficulty(userLevel);
    }
    
    // æ·»åŠ åŠ¨ç”»æ•ˆæœ
    const cards = document.querySelectorAll('.theory-card, .interactive-item, .progress-item');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        setTimeout(() => {
            card.style.transition = 'all 0.6s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });
});
</script>
{% endblock %}
