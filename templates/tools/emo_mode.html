{% extends 'base.html' %}
{% load static %}

{% block tool_title_inner %}Emoæ¨¡å¼{% endblock %}
{% block tool_title_display %}Emoæ¨¡å¼{% endblock %}

{% block extra_css %}
<style>


.rage-container {
  min-height: 100vh;
  background: linear-gradient(135deg, #2c3e50 0%, #34495e 25%, #7f8c8d 50%, #95a5a6 75%, #bdc3c7 100%);
  color: #ffffff;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
  transition: all 0.3s ease;
}

/* èºåŠ¨æ¨¡å¼æ ·å¼ */
.rage-container.agitated {
  background: linear-gradient(135deg, #e74c3c 0%, #c0392b 25%, #e67e22 50%, #f39c12 75%, #f1c40f 100%);
  animation: agitatedShake 0.5s ease-in-out infinite;
}

@keyframes agitatedShake {
  0%, 100% { 
    transform: translateX(0) translateY(0) rotate(0deg);
  }
  10% { 
    transform: translateX(-2px) translateY(-1px) rotate(-0.5deg);
  }
  20% { 
    transform: translateX(2px) translateY(1px) rotate(0.5deg);
  }
  30% { 
    transform: translateX(-1px) translateY(-2px) rotate(-0.3deg);
  }
  40% { 
    transform: translateX(1px) translateY(2px) rotate(0.3deg);
  }
  50% { 
    transform: translateX(-3px) translateY(-1px) rotate(-0.7deg);
  }
  60% { 
    transform: translateX(3px) translateY(1px) rotate(0.7deg);
  }
  70% { 
    transform: translateX(-1px) translateY(-3px) rotate(-0.2deg);
  }
  80% { 
    transform: translateX(1px) translateY(3px) rotate(0.2deg);
  }
  90% { 
    transform: translateX(-2px) translateY(-1px) rotate(-0.4deg);
  }
}

.rage-container::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: 
    radial-gradient(circle at 20% 80%, rgba(44, 62, 80, 0.3) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(52, 73, 94, 0.3) 0%, transparent 50%),
    radial-gradient(circle at 40% 60%, rgba(127, 140, 141, 0.2) 0%, transparent 50%);
  z-index: -1;
  /* å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œåªåœ¨ç”¨æˆ·äº¤äº’æ—¶æ’­æ”¾ */
  animation: none;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„èƒŒæ™¯åŠ¨ç”» */
.rage-container.agitated::before {
  background: 
    radial-gradient(circle at 20% 80%, rgba(231, 76, 60, 0.4) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(192, 57, 43, 0.4) 0%, transparent 50%),
    radial-gradient(circle at 40% 60%, rgba(230, 126, 34, 0.3) 0%, transparent 50%);
  animation: agitatedPulse 0.8s ease-in-out infinite;
}

@keyframes agitatedPulse {
  0%, 100% { 
    transform: scale(1) rotate(0deg);
    opacity: 0.6;
  }
  50% { 
    transform: scale(1.02) rotate(1deg);
    opacity: 0.9;
  }
}

/* åªåœ¨ç”¨æˆ·æ‚¬åœæ—¶æ’­æ”¾åŠ¨ç”» */
.rage-container:hover::before {
  animation: emoPulse 5s ease-in-out infinite;
}

@keyframes emoPulse {
  0%, 100% { 
    transform: scale(1) rotate(0deg);
    opacity: 0.5;
  }
  50% { 
    transform: scale(1.005) rotate(0.2deg);
    opacity: 0.8;
  }
}

/* æµ®åŠ¨éŸ³ç¬¦åŠ¨ç”» */
.floating-notes {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
}

.note {
  position: absolute;
  font-size: 2rem;
  /* å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œåªåœ¨ç”¨æˆ·äº¤äº’æ—¶æ’­æ”¾ */
  animation: none;
  opacity: 0.5;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„éŸ³ç¬¦åŠ¨ç”» */
.rage-container.agitated .note {
  animation: agitatedFloat 1s ease-in-out infinite;
  opacity: 0.8;
}

@keyframes agitatedFloat {
  0%, 100% { 
    transform: translateY(0px) rotate(0deg) scale(1);
    opacity: 0.8;
  }
  25% { 
    transform: translateY(-30px) rotate(90deg) scale(1.3);
    opacity: 1;
  }
  50% { 
    transform: translateY(-20px) rotate(180deg) scale(0.7);
    opacity: 0.6;
  }
  75% { 
    transform: translateY(-50px) rotate(270deg) scale(1.5);
    opacity: 1;
  }
}

/* åªåœ¨ç”¨æˆ·æ‚¬åœæ—¶æ’­æ”¾åŠ¨ç”» */
.floating-notes:hover .note {
  animation: floatNote 8s ease-in-out infinite;
}

.note:nth-child(1) { top: 15%; left: 10%; }
.note:nth-child(2) { top: 25%; right: 20%; }
.note:nth-child(3) { bottom: 35%; left: 15%; }
.note:nth-child(4) { bottom: 20%; right: 15%; }
.note:nth-child(5) { top: 55%; left: 8%; }
.note:nth-child(6) { top: 65%; right: 8%; }

@keyframes floatNote {
  0%, 100% { 
    transform: translateY(0px) rotate(0deg) scale(1);
    opacity: 0.5;
  }
  25% { 
    transform: translateY(-20px) rotate(45deg) scale(1.1);
    opacity: 0.8;
  }
  50% { 
    transform: translateY(-15px) rotate(180deg) scale(0.8);
    opacity: 0.5;
  }
  75% { 
    transform: translateY(-45px) rotate(270deg) scale(1.2);
    opacity: 0.9;
  }
}

.rage-header {
  text-align: center;
  margin-bottom: 4rem;
  padding: 3rem 0;
  position: relative;
  z-index: 1;
  transition: all 0.3s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„æ ‡é¢˜åŠ¨ç”» */
.rage-container.agitated .rage-header {
  animation: agitatedHeader 0.6s ease-in-out infinite;
}

@keyframes agitatedHeader {
  0%, 100% { 
    transform: translateY(0px) scale(1);
  }
  50% { 
    transform: translateY(-5px) scale(1.02);
  }
}

.rage-title {
  color: #f093fb;
  font-size: 4rem;
  font-weight: 900;
  margin-bottom: 1rem;
  text-shadow: 0 0 30px rgba(240, 147, 251, 0.5);
  letter-spacing: 2px;
  text-transform: uppercase;
  animation: titleGlow 3s ease-in-out infinite;
  transition: all 0.3s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„æ ‡é¢˜æ ·å¼ */
.rage-container.agitated .rage-title {
  color: #ff4757;
  text-shadow: 0 0 30px rgba(255, 71, 87, 0.8);
  animation: agitatedTitleGlow 0.8s ease-in-out infinite;
}

@keyframes agitatedTitleGlow {
  0%, 100% { 
    text-shadow: 0 0 30px rgba(255, 71, 87, 0.8);
    transform: scale(1);
  }
  50% { 
    text-shadow: 0 0 50px rgba(255, 71, 87, 1);
    transform: scale(1.05);
  }
}

@keyframes titleGlow {
  0%, 100% { text-shadow: 0 0 30px rgba(240, 147, 251, 0.5); }
  50% { text-shadow: 0 0 50px rgba(240, 147, 251, 0.8); }
}

.rage-subtitle {
  font-size: 1.3rem;
  color: rgba(255, 255, 255, 0.9);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 1px;
  animation: subtitleFloat 4s ease-in-out infinite;
  transition: all 0.3s ease;
  min-height: 1.5em;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„å‰¯æ ‡é¢˜æ ·å¼ */
.rage-container.agitated .rage-subtitle {
  color: rgba(255, 255, 255, 1);
  animation: agitatedSubtitleFloat 1s ease-in-out infinite;
}

@keyframes agitatedSubtitleFloat {
  0%, 100% { 
    transform: translateY(0px) scale(1);
    opacity: 1;
  }
  50% { 
    transform: translateY(-8px) scale(1.02);
    opacity: 0.8;
  }
}

@keyframes subtitleFloat {
  0%, 100% { transform: translateY(0px); opacity: 0.9; }
  50% { transform: translateY(-5px); opacity: 1; }
}

.rage-tools-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 2.5rem;
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
  z-index: 1;
  transition: all 0.3s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„å·¥å…·ç½‘æ ¼åŠ¨ç”» */
.rage-container.agitated .rage-tools-grid {
  animation: agitatedGrid 0.7s ease-in-out infinite;
}

@keyframes agitatedGrid {
  0%, 100% { 
    transform: translateY(0px) scale(1);
  }
  50% { 
    transform: translateY(-3px) scale(1.01);
  }
}

.training-card {
  background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.05) 100%);
  border: 2px solid rgba(240, 147, 251, 0.2);
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(240, 147, 251, 0.1);
  backdrop-filter: blur(20px);
  transition: all 0.4s ease;
  padding: 28px;
  text-align: center;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„å¡ç‰‡æ ·å¼ */
.rage-container.agitated .training-card {
  background: linear-gradient(135deg, rgba(255, 71, 87, 0.15) 0%, rgba(255, 152, 0, 0.1) 100%);
  border: 2px solid rgba(255, 71, 87, 0.3);
  box-shadow: 0 8px 32px rgba(255, 71, 87, 0.2);
  animation: agitatedCard 0.9s ease-in-out infinite;
}

@keyframes agitatedCard {
  0%, 100% { 
    transform: translateY(0px) scale(1);
    border-color: rgba(255, 71, 87, 0.3);
  }
  50% { 
    transform: translateY(-5px) scale(1.03);
    border-color: rgba(255, 152, 0, 0.5);
  }
}

.training-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 50%, #667eea 100%);
  transform: scaleX(0);
  transition: transform 0.4s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„å¡ç‰‡é¡¶éƒ¨æ¡ */
.rage-container.agitated .training-card::after {
  background: linear-gradient(135deg, #ff4757 0%, #ffa502 50%, #ff6348 100%);
  transform: scaleX(1);
  animation: agitatedBar 1s ease-in-out infinite;
}

@keyframes agitatedBar {
  0%, 100% { 
    opacity: 1;
  }
  50% { 
    opacity: 0.5;
  }
}

.training-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(240, 147, 251, 0.1), transparent);
  transition: left 1s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„å¡ç‰‡å…‰æ•ˆ */
.rage-container.agitated .training-card::before {
  background: linear-gradient(90deg, transparent, rgba(255, 71, 87, 0.2), transparent);
  animation: agitatedShine 1.2s ease-in-out infinite;
}

@keyframes agitatedShine {
  0% { left: -100%; }
  50% { left: 100%; }
  100% { left: 100%; }
}

.training-card:hover::after {
  transform: scaleX(1);
}

.training-card:hover::before {
  left: 100%;
}

.training-card:hover {
  box-shadow: 0 16px 48px rgba(240, 147, 251, 0.2);
  transform: translateY(-8px) scale(1.03);
  border-color: rgba(240, 147, 251, 0.4);
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„æ‚¬åœæ•ˆæœ */
.rage-container.agitated .training-card:hover {
  box-shadow: 0 16px 48px rgba(255, 71, 87, 0.3);
  transform: translateY(-12px) scale(1.05);
  border-color: rgba(255, 152, 0, 0.6);
}

.training-icon {
  font-size: 3.5rem;
  margin-bottom: 1.5rem;
  color: #f093fb;
  text-shadow: 0 0 20px rgba(240, 147, 251, 0.5);
  /* å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œåªåœ¨æ‚¬åœæ—¶æ’­æ”¾ */
  animation: none;
  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: auto;
  transform: translateZ(0);
  transition: all 0.3s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„å›¾æ ‡æ ·å¼ */
.rage-container.agitated .training-icon {
  color: #ff4757;
  text-shadow: 0 0 20px rgba(255, 71, 87, 0.8);
  animation: agitatedIconFloat 1.1s ease-in-out infinite;
}

@keyframes agitatedIconFloat {
  0%, 100% { 
    transform: translateY(0) rotate(0deg) scale(1);
  }
  25% { 
    transform: translateY(-8px) rotate(5deg) scale(1.1);
  }
  50% { 
    transform: translateY(-5px) rotate(-3deg) scale(0.9);
  }
  75% { 
    transform: translateY(-10px) rotate(8deg) scale(1.2);
  }
}

/* åªåœ¨æ‚¬åœæ—¶æ’­æ”¾åŠ¨ç”» */
.training-card:hover .training-icon {
  animation: iconFloat 3s ease-in-out infinite;
}

@keyframes iconFloat {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-5px) rotate(3deg); }
}

.training-title {
  font-size: 1.6rem;
  font-weight: 700;
  margin-bottom: 1rem;
  color: #ffffff;
  text-transform: uppercase;
  letter-spacing: 1px;
  transition: all 0.3s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„æ ‡é¢˜æ ·å¼ */
.rage-container.agitated .training-title {
  color: #ffffff;
  text-shadow: 0 0 10px rgba(255, 71, 87, 0.8);
  animation: agitatedTitle 0.8s ease-in-out infinite;
}

@keyframes agitatedTitle {
  0%, 100% { 
    transform: scale(1);
    text-shadow: 0 0 10px rgba(255, 71, 87, 0.8);
  }
  50% { 
    transform: scale(1.02);
    text-shadow: 0 0 15px rgba(255, 71, 87, 1);
  }
}

.training-description {
  font-size: 1rem;
  color: rgba(255, 255, 255, 0.8);
  line-height: 1.6;
  margin-bottom: 1.5rem;
  transition: all 0.3s ease;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„æè¿°æ ·å¼ */
.rage-container.agitated .training-description {
  color: rgba(255, 255, 255, 0.9);
  animation: agitatedDescription 1.2s ease-in-out infinite;
}

@keyframes agitatedDescription {
  0%, 100% { 
    opacity: 0.9;
  }
  50% { 
    opacity: 0.7;
  }
}

.training-btn {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  color: #ffffff;
  border: none;
  padding: 1rem 2rem;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 1px;
  box-shadow: 0 8px 24px rgba(240, 147, 251, 0.4);
  position: relative;
  overflow: hidden;
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„æŒ‰é’®æ ·å¼ */
.rage-container.agitated .training-btn {
  background: linear-gradient(135deg, #ff4757 0%, #ffa502 100%);
  box-shadow: 0 8px 24px rgba(255, 71, 87, 0.5);
  animation: agitatedButton 1s ease-in-out infinite;
}

@keyframes agitatedButton {
  0%, 100% { 
    transform: scale(1);
    box-shadow: 0 8px 24px rgba(255, 71, 87, 0.5);
  }
  50% { 
    transform: scale(1.05);
    box-shadow: 0 12px 32px rgba(255, 71, 87, 0.7);
  }
}

.training-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.6s ease;
}

.training-btn:hover::before {
  left: 100%;
}

.training-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 32px rgba(240, 147, 251, 0.7);
}

/* èºåŠ¨æ¨¡å¼ä¸‹çš„æŒ‰é’®æ‚¬åœæ•ˆæœ */
.rage-container.agitated .training-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 16px 40px rgba(255, 71, 87, 0.8);
}

/* ç‚¹å‡»è®¡æ•°å™¨æç¤º */
.click-counter {
  position: fixed;
  top: 20px;
  right: 20px;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 10px 15px;
  border-radius: 20px;
  font-size: 0.9rem;
  z-index: 1000;
  opacity: 0;
  transform: translateY(-20px);
  transition: all 0.3s ease;
}

.click-counter.show {
  opacity: 1;
  transform: translateY(0);
}

.click-counter.agitated {
  background: rgba(255, 71, 87, 0.9);
  animation: agitatedCounter 0.5s ease-in-out infinite;
}

@keyframes agitatedCounter {
  0%, 100% { 
    transform: translateY(0) scale(1);
  }
  50% { 
    transform: translateY(-3px) scale(1.05);
  }
}

@media (max-width: 768px) {
  .rage-title {
    font-size: 2.5rem;
  }
  
  .rage-tools-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .rage-container {
    padding: 1rem;
  }
  
  .note {
    font-size: 1.5rem;
  }
  
  .click-counter {
    top: 10px;
    right: 10px;
    font-size: 0.8rem;
    padding: 8px 12px;
  }
}
</style>
{% endblock %}

{% block content %}
<div class="rage-container" id="rageContainer">
  <!-- è¿”å›æŒ‰é’® -->
  

  <!-- ç‚¹å‡»è®¡æ•°å™¨æç¤º -->
  <div class="click-counter" id="clickCounter">
    ç‚¹å‡»æ¬¡æ•°: <span id="clickCount">0</span>
  </div>

  <!-- æµ®åŠ¨æƒ…ç»ªç¬¦å·èƒŒæ™¯ -->
  <div class="floating-notes">
    <div class="note">ğŸ’”</div>
    <div class="note">ğŸ˜¢</div>
    <div class="note">ğŸŒ§ï¸</div>
    <div class="note">ğŸ’­</div>
    <div class="note">ğŸµ</div>
    <div class="note">ğŸ’œ</div>
  </div>

  <div class="rage-header">
    <h1 class="rage-title">
      <i class="fas fa-music"></i> Emoæ¨¡å¼
    </h1>
    <p class="rage-subtitle" id="emoSubtitle">ğŸ’œ å¥¹è¯´éš¾è¿‡å¥½è¿‡æ²¡æœ‰æ„Ÿæƒ…</p>
  </div>

  <div class="rage-tools-grid">
    <div class="training-card" onclick="window.location.href='{% url 'tools:self_analysis' %}'">
      <div class="training-icon">
        <i class="fas fa-brain"></i>
      </div>
      <h3 class="training-title">è‡ªæˆ‘åˆ†æ</h3>
      <p class="training-description">æ·±åº¦æƒ…æ„Ÿæ¢ç´¢ï¼Œè‡ªæˆ‘è®¤çŸ¥ï¼Œæƒ…ç»ªæ¨¡å¼åˆ†æ</p>
    </div>

    <div class="training-card" onclick="window.location.href='{% url 'tools:storyboard' %}'">
      <div class="training-icon">
        <i class="fas fa-film"></i>
      </div>
      <h3 class="training-title">æ•…äº‹æ¿ç”Ÿæˆ</h3>
      <p class="training-description">å¿«é€Ÿç”Ÿæˆæ•…äº‹æ¿ï¼Œå¯è§†åŒ–åˆ›æ„æ„æ€ï¼Œæå‡é¡¹ç›®æ•ˆç‡</p>
    </div>

    <div class="training-card" onclick="window.location.href='{% url 'tools:fortune_analyzer' %}'">
      <div class="training-icon">
                        <i class="fas fa-star"></i>
      </div>
      <h3 class="training-title">å§»ç¼˜æµ‹ç®—</h3>
      <p class="training-description">æ¢ç´¢å†…å¿ƒä¸–ç•Œï¼Œå¯»æ‰¾æƒ…æ„Ÿç­”æ¡ˆï¼ŒæŒ‡å¼•å¿ƒçµæ–¹å‘</p>
    </div>

    <div class="training-card" onclick="window.location.href='{% url 'tools:tarot_reading' %}'">
      <div class="training-icon">
        <i class="fas fa-moon"></i>
      </div>
      <h3 class="training-title">çµå¢ƒå¡”ç½—</h3>
      <p class="training-description">ç¥ç§˜å¡”ç½—å åœï¼Œæ¢ç´¢å‘½è¿å¥¥ç§˜ï¼Œå¯»æ‰¾å†…å¿ƒç­”æ¡ˆ</p>
    </div>



            <div class="training-card" onclick="window.location.href='{% url 'tools:meetsomeone_dashboard' %}'">
      <div class="training-icon">
        <i class="fas fa-users"></i>
      </div>
      <h3 class="training-title">äººé™…æ¡£æ¡ˆ</h3>
      <p class="training-description">è®°å½•ç”Ÿå‘½ä¸­çš„é‡è¦è¿æ¥ï¼Œçè—æ¯ä¸€ä»½æƒ…æ„Ÿä¸å›å¿†</p>
    </div>

   
  </div>
</div>

<script>
// ç‚¹å‡»è®¡æ•°å™¨åŠŸèƒ½
let clickCount = 0;
let clickTimeout;
const rageContainer = document.getElementById('rageContainer');
const clickCounter = document.getElementById('clickCounter');
const clickCountSpan = document.getElementById('clickCount');

// é¡µé¢ç‚¹å‡»äº‹ä»¶
rageContainer.addEventListener('click', function(e) {
  // å¦‚æœç‚¹å‡»çš„æ˜¯å¡ç‰‡ï¼Œä¸å¢åŠ è®¡æ•°ï¼ˆé¿å…ä¸å¡ç‰‡ç‚¹å‡»å†²çªï¼‰
  if (e.target.closest('.training-card')) {
    return;
  }
  
  clickCount++;
  clickCountSpan.textContent = clickCount;
  
  // æ˜¾ç¤ºè®¡æ•°å™¨
  clickCounter.classList.add('show');
  
  // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
  clearTimeout(clickTimeout);
  
  // 3ç§’åéšè—è®¡æ•°å™¨
  clickTimeout = setTimeout(() => {
    clickCounter.classList.remove('show');
  }, 3000);
  
  // å¦‚æœç‚¹å‡»æ¬¡æ•°è¾¾åˆ°3æ¬¡æˆ–ä»¥ä¸Šï¼Œè§¦å‘èºåŠ¨æ¨¡å¼
  if (clickCount >= 3) {
    rageContainer.classList.add('agitated');
    clickCounter.classList.add('agitated');
    
    // æ·»åŠ èºåŠ¨æç¤º
    clickCounter.innerHTML = `ç‚¹å‡»æ¬¡æ•°: <span id="clickCount">${clickCount}</span> - èºåŠ¨æ¨¡å¼å·²æ¿€æ´»ï¼`;
    
    // æ’­æ”¾èºåŠ¨éŸ³æ•ˆï¼ˆå¯é€‰ï¼‰
    playAgitatedSound();
    
    // é‡ç½®è®¡æ•°å™¨ï¼ˆå¯é€‰ï¼Œè®©ç”¨æˆ·ç»§ç»­ç‚¹å‡»ä¿æŒèºåŠ¨çŠ¶æ€ï¼‰
    // clickCount = 0;
  }
});

// èºåŠ¨éŸ³æ•ˆå‡½æ•°ï¼ˆå¯é€‰ï¼‰
function playAgitatedSound() {
  // åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();
  
  // åˆ›å»ºèºåŠ¨éŸ³æ•ˆ
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  // è®¾ç½®éŸ³æ•ˆå‚æ•°
  oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
  oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.1);
  oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.2);
  
  gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
  
  // æ’­æ”¾éŸ³æ•ˆ
  oscillator.start(audioContext.currentTime);
  oscillator.stop(audioContext.currentTime + 0.2);
}

// é”®ç›˜äº‹ä»¶æ”¯æŒï¼ˆå¯é€‰ï¼‰
document.addEventListener('keydown', function(e) {
  // æŒ‰ç©ºæ ¼é”®ä¹Ÿå¯ä»¥è§¦å‘èºåŠ¨æ¨¡å¼
  if (e.code === 'Space') {
    e.preventDefault();
    clickCount += 2; // ç©ºæ ¼é”®å¢åŠ 2æ¬¡ç‚¹å‡»
    clickCountSpan.textContent = clickCount;
    
    clickCounter.classList.add('show');
    clearTimeout(clickTimeout);
    
    clickTimeout = setTimeout(() => {
      clickCounter.classList.remove('show');
    }, 3000);
    
    if (clickCount >= 3) {
      rageContainer.classList.add('agitated');
      clickCounter.classList.add('agitated');
      clickCounter.innerHTML = `ç‚¹å‡»æ¬¡æ•°: <span id="clickCount">${clickCount}</span> - èºåŠ¨æ¨¡å¼å·²æ¿€æ´»ï¼`;
      playAgitatedSound();
    }
  }
  
  // æŒ‰ESCé”®é‡ç½®èºåŠ¨æ¨¡å¼
  if (e.code === 'Escape') {
    rageContainer.classList.remove('agitated');
    clickCounter.classList.remove('agitated');
    clickCount = 0;
    clickCountSpan.textContent = clickCount;
    clickCounter.innerHTML = `ç‚¹å‡»æ¬¡æ•°: <span id="clickCount">${clickCount}</span>`;
    clickCounter.classList.remove('show');
  }
});

// é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
  // æ·»åŠ é¡µé¢åŠ è½½æç¤º
  setTimeout(() => {
    clickCounter.innerHTML = `ç‚¹å‡»é¡µé¢3æ¬¡æ¿€æ´»èºåŠ¨æ¨¡å¼ï¼`;
    clickCounter.classList.add('show');
    
    setTimeout(() => {
      clickCounter.classList.remove('show');
    }, 3000);
  }, 1000);
  
  // å¯åŠ¨å‰¯æ ‡é¢˜è½®æ¢
  startSubtitleRotation();
});

// Emoæ¨¡å¼å‰¯æ ‡é¢˜è½®æ¢åŠŸèƒ½
let subtitleIndex = 0;
let subtitleInterval;

function startSubtitleRotation() {
  const subtitleElement = document.getElementById('emoSubtitle');
  if (!subtitleElement) return;
  
  const emoSubtitles = [
    'ğŸ’œ å¥¹è¯´éš¾è¿‡å¥½è¿‡æ²¡æœ‰æ„Ÿæƒ…',
    'ğŸ’œ æˆ‘åªæƒ³è¦ä¸ªç­”æ¡ˆ',
    'ğŸ’œ æƒ…æ„Ÿéœ€è¦è¢«çœ‹è§',
    'ğŸ’œ æ¯ä¸€ä¸ªæƒ…ç»ªéƒ½å€¼å¾—è¢«å€¾å¬',
    'ğŸ’œ åœ¨é»‘æš—ä¸­å¯»æ‰¾å…‰æ˜',
    'ğŸ’œ è®©å¿ƒçµå¾—åˆ°ç–—æ„ˆ'
  ];
  
  // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
  if (subtitleInterval) {
    clearInterval(subtitleInterval);
  }
  
  // è®¾ç½®è½®æ¢é—´éš”ï¼ˆæ¯5ç§’è½®æ¢ä¸€æ¬¡ï¼‰
  subtitleInterval = setInterval(() => {
    subtitleElement.style.opacity = '0';
    subtitleElement.style.transform = 'translateY(-10px)';
    
    setTimeout(() => {
      subtitleIndex = (subtitleIndex + 1) % emoSubtitles.length;
      subtitleElement.textContent = emoSubtitles[subtitleIndex];
      subtitleElement.style.opacity = '1';
      subtitleElement.style.transform = 'translateY(0)';
    }, 300);
  }, 5000);
}
</script>
{% endblock %} 